# Pre-commit configuration for Victor AI
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: Trim trailing whitespace
        exclude: ^(tests/|examples/)
      - id: end-of-file-fixer
        name: Fix end of files
        exclude: ^(tests/|examples/)
      - id: check-yaml
        name: Check YAML syntax
        args:
          - --unsafe
        - id: check-toml
        name: Check TOML syntax
        - id: check-json
        name: Check JSON syntax
        - id: check-added-large-files
        name: Check for large files
        - id: check-merge-conflict
        name: Check for merge conflicts
        - id: check-case-conflict
        name: Check for case conflicts
        - id: detect-private-key
        name: Detect private keys
        - id: mixed-line-ending
        name: Fix mixed line endings
        args:
          - --fix=lf
      - repo: https://github.com/psf/black
        rev: 24.3.0
        hooks:
          - id: black
            name: Format code with Black
            language_version: python3.11
            args:
              - --config
              - pyproject.toml
      - repo: https://github.com/astral-sh/ruff-pre-commit
        rev: v0.5.0
        hooks:
          - id: ruff
            name: Lint with Ruff
            language_version: python3.11
            args:
              - --fix
              - --exit-non-zero-on-fix
              - --config=pyproject.toml
      - repo: https://github.com/pre-commit/mirrors-mypy
        rev: v1.10.0
        hooks:
          - id: mypy
            name: Type check with MyPy (strict modules)
            entry: mypy victor/protocols victor/framework/coordinators victor/core/registries
              --config-file=pyproject.toml
      - repo: https://github.com/pyupio/safety
        rev: 3.2.4
        hooks:
          - id: safety
            name: Check for security vulnerabilities in dependencies
            entry: scripts/hooks/safety.sh
            language: script
            files: pyproject.toml
            args:
              - --ignore
                - '12345'
            exclude: ^(tests/fixtures/|tests/conftest.py)
      - repo: https://github.com/macisamuele/language-formatters-pre-commit-hooks
        rev: v2.13.0
        hooks:
          - id: pretty-format-yaml
            name: Format YAML files
            args:
              - --autofix
              - --indent
              - '2'
              - --offset
              - '2'
            exclude: ^(mkdocs\.yml|\.github/)
      - repo: https://github.com/adrienverge/yamllint
        rev: v2.12.0
        hooks:
          - id: yamllint
            name: Lint YAML files
            args:
              - --fix
              - -c=.yamllint.yml
            exclude: ^(tests/|examples/)
      - repo: local
        hooks:
          - id: check-todos
            name: Check for TODO/FIXME comments
            entry: python scripts/check_todos.sh
            language: python
            files: ^victor/.*\.py$
      - repo: https://github.com/PyCQA/bandit
        rev: 1.7.8
        hooks:
          - id: bandit
            name: Security check with Bandit
            entry: scripts/hooks/bandit.sh
            language: script
            files: pyproject.toml
            args:
              - '-c'
              - 'pyproject.toml'
              - -ll'
            exclude: ^(tests/fixtures/|tests/conftest.py)
      - repo: https://github.com/python-jsonschema/check-jsonschema
        rev: 0.28.0
        hooks:
          - id: check-json
            name: Check JSON syntax
            entry: scripts/hooks/check_json.py
            language: python
            files: .*\.py$
      - repo: https://github.com/pre-commit/mirrors-mypy
        rev: v1.10.0
        hooks:
          - id: mypy
            name: Type check with MyPy (strict modules)
            entry: mypy victor/protocols victor/framework/coordinators victor/core/registries
              --config-file=pyproject.toml
      - repo: https://github.com/astral-sh/ruff-pre-commit
        rev: v0.5.0
        hooks:
          - id: ruff
            name: Lint with Ruff
            language_version: python3.11
            args:
              - --fix
              - --exit-non-zero-on-fix
              - --config=pyproject.toml
      - repo: https://github.com/pre-commit/mirrors-mypy
        rev: v1.10.0
        hooks:
          - id: mypy
            name: Type check with MyPy (strict modules)
            entry: mypy victor/protocols victor/framework/coordinators victor/core/registries
              --config-file=pyproject.toml
      - repo: https://github.com/pre-commit/mirrors-mypy
        rev: v1.10.0
        hooks:
          - id: mypy
            name: Type check with MyPy (strict modules)
            entry: mypy victor/protocols victor/framework/coordinators victor/core/registries
              --config-file=pyproject.toml
      - repo: https://github.com/astral-sh/ruff-pre-commit
        rev: v0.5.0
        hooks:
          - id: ruff
            name: Lint with Ruff
            language_version: python3.11
            args:
              - --fix
              - --exit-non-zero-on-fix
              - --config=pyproject.toml
      - repo: local
        hooks:
          - id: check-todos
            name: Check for TODO/FIXME comments
            entry: python scripts/check_todos.sh
            language: python
            files: ^victor/.*\.py$
      - repo: local
        hooks:
          - id: pytest-changed-files
            name: Run pytest on changed Python files.
            entry: pytest -x -v --tb=short -m "not slow and not integration"
            language: python
            files: ^victor/.*\.py$|^tests/unit/.*\.py$
            pass_filenames: false
            skip:
              - config-file:/tmp/slow_tests.txt
