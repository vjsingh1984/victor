============================= test session starts ==============================
platform darwin -- Python 3.12.6, pytest-9.0.2, pluggy-1.6.0 -- /Users/vijaysingh/code/.venv/bin/python3.12
cachedir: .pytest_cache
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
metadata: {'Python': '3.12.6', 'Platform': 'macOS-26.2-arm64-arm-64bit', 'Packages': {'pytest': '9.0.2', 'pluggy': '1.6.0'}, 'Plugins': {'anyio': '4.12.1', 'benchmark': '5.2.3', 'respx': '0.22.0', 'mock': '3.15.1', 'json-report': '1.5.0', 'metadata': '3.1.1', 'asyncio': '1.3.0', 'locust': '2.43.1', 'cov': '7.0.0'}, 'JAVA_HOME': '/Library/Java/JavaVirtualMachines/jdk-19.jdk/Contents/Home'}
rootdir: /Users/vijaysingh/code/codingagent
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.1, benchmark-5.2.3, respx-0.22.0, mock-3.15.1, json-report-1.5.0, metadata-3.1.1, asyncio-1.3.0, locust-2.43.1, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 24925 items / 5 deselected / 2 skipped / 24920 selected

tests/unit/agent/cache/backends/test_factory.py::TestMemoryBackendCreation::test_create_memory_backend_default_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestMemoryBackendCreation::test_create_memory_backend_with_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestMemoryBackendCreation::test_create_memory_backend_with_empty_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestRedisBackendCreation::test_create_redis_backend_with_required_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestRedisBackendCreation::test_create_redis_backend_missing_required_option PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestRedisBackendCreation::test_create_redis_backend_with_all_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestSQLiteBackendCreation::test_create_sqlite_backend_default_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestSQLiteBackendCreation::test_create_sqlite_backend_with_file_path PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestSQLiteBackendCreation::test_create_sqlite_backend_with_all_options PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestDefaultBackend::test_create_default_backend PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_valid_memory_config PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_valid_sqlite_config PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_valid_redis_config PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_missing_type PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_unknown_backend_type PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_redis_missing_required_option PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestConfigurationValidation::test_validate_config_not_dict PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestErrorHandling::test_create_backend_with_invalid_type PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestErrorHandling::test_create_backend_without_type PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestErrorHandling::test_create_backend_config_not_dict PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestErrorHandling::test_create_redis_backend_without_url PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestFactoryIntegration::test_memory_backend_integration PASSED [  0%]
tests/unit/agent/cache/backends/test_factory.py::TestFactoryIntegration::test_sqlite_backend_integration PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestConnectionLifecycle::test_connect_establishes_connection PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestConnectionLifecycle::test_connect_creates_pubsub PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestConnectionLifecycle::test_disconnect_closes_pubsub PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestConnectionLifecycle::test_disconnect_closes_redis PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestConnectionLifecycle::test_multiple_connect_calls_idempotent PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestConnectionLifecycle::test_multiple_disconnect_calls_safe PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestBasicCacheOperations::test_get_returns_cached_value PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestBasicCacheOperations::test_get_returns_none_for_missing_key PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestBasicCacheOperations::test_set_stores_value PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestBasicCacheOperations::test_set_with_custom_ttl PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestBasicCacheOperations::test_delete_removes_key PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestBasicCacheOperations::test_delete_returns_false_for_missing_key PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestNamespaceManagement::test_clear_namespace_deletes_all_keys PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestNamespaceManagement::test_clear_namespace_returns_zero_for_empty_namespace PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestNamespaceManagement::test_namespace_isolation PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestStatistics::test_get_stats_returns_backend_type PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestStatistics::test_get_stats_returns_key_count PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestStatistics::test_get_stats_returns_memory_usage PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestDistributedInvalidation::test_invalidate_publish_sends_message PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestDistributedInvalidation::test_listen_for_invalidation_calls_callback PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestDistributedInvalidation::test_listen_for_invalidation_ignores_non_message_types PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestKeyPrefix::test_key_prefix_applied_to_all_operations PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestKeyPrefix::test_default_key_prefix PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestErrorHandling::test_get_before_connect_raises_error PASSED [  0%]
tests/unit/agent/cache/backends/test_redis_backend.py::TestErrorHandling::test_set_before_connect_raises_error PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestConnectionLifecycle::test_connect_creates_database PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestConnectionLifecycle::test_connect_creates_cache_table PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestConnectionLifecycle::test_connect_creates_indexes PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestConnectionLifecycle::test_disconnect_closes_connection PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestConnectionLifecycle::test_multiple_connect_calls_idempotent PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestConnectionLifecycle::test_multiple_disconnect_calls_safe PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_get_returns_cached_value PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_get_returns_none_for_missing_key PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_set_stores_value PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_set_with_custom_ttl PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_set_without_ttl_uses_default PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_delete_removes_key PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestBasicCacheOperations::test_delete_returns_false_for_missing_key PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestNamespaceManagement::test_namespace_isolation PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestNamespaceManagement::test_clear_namespace_deletes_all_keys PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestNamespaceManagement::test_clear_namespace_returns_zero_for_empty_namespace PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestTTLAndExpiration::test_expired_entries_not_returned PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestTTLAndExpiration::test_cleanup_expired_removes_old_entries PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestTTLAndExpiration::test_cleanup_expired_returns_zero_when_no_expired PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestStatistics::test_get_stats_returns_backend_type PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestStatistics::test_get_stats_returns_key_count PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestStatistics::test_get_stats_returns_db_size PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestPersistence::test_cache_persists_across_reconnects PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestPersistence::test_expired_entries_cleanup_on_reconnect PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestThreadSafety::test_concurrent_get_operations PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestThreadSafety::test_concurrent_set_operations PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestErrorHandling::test_get_before_connect_raises_error PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestErrorHandling::test_set_before_connect_raises_error PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestErrorHandling::test_unpickleable_value_raises_error PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestDistributedInvalidation::test_invalidate_publish_raises_not_implemented PASSED [  0%]
tests/unit/agent/cache/backends/test_sqlite_backend.py::TestDistributedInvalidation::test_listen_for_invalidation_raises_not_implemented PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_get_set_delete PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_get_nonexistent_key PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_delete_nonexistent_key PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_set_with_ttl PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_set_without_ttl PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_namespace_isolation PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_clear_namespace PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_get_stats PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_overwrite_existing_key PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_complex_values PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestMemoryCacheBackend::test_cache_namespace_hierarchy PASSED [  0%]
tests/unit/agent/cache/test_cache_backends.py::TestCacheBackendProtocol::test_memory_backend_implements_protocol PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestCommonArgumentPatterns::test_extract_single_file_path PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestCommonArgumentPatterns::test_extract_from_file_argument PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestCommonArgumentPatterns::test_extract_from_files_list PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestCommonArgumentPatterns::test_extract_from_directory_argument PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestCommonArgumentPatterns::test_extract_from_dir_argument PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestCommonArgumentPatterns::test_extract_from_dirs_list PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestMixedArguments::test_extract_path_and_files PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestMixedArguments::test_extract_from_all_patterns PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestEdgeCases::test_empty_arguments PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestEdgeCases::test_no_file_arguments PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestEdgeCases::test_empty_files_list PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestEdgeCases::test_none_values PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestEdgeCases::test_non_string_values PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestToolSpecificExtraction::test_read_file_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestToolSpecificExtraction::test_write_file_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestToolSpecificExtraction::test_grep_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestToolSpecificExtraction::test_code_search_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestToolSpecificExtraction::test_glob_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestAdvancedScenarios::test_relative_paths PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestAdvancedScenarios::test_nested_paths_in_lists PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestAdvancedScenarios::test_duplicate_paths PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestAdvancedScenarios::test_mixed_valid_invalid_paths PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestPerformance::test_large_file_list PASSED [  0%]
tests/unit/agent/cache/test_dependency_extractor.py::TestPerformance::test_many_arguments PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_init_empty PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_add_tool_dependency PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_add_file_dependency PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_dependents PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_dependents_empty PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_file_dependents PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_file_dependents_empty PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_transitive_dependents PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_transitive_dependents_empty PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_dependencies PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_file_dependencies PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_remove_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_remove_file_dependency PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_clear PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_get_stats PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_multiple_dependencies_same_tool PASSED [  0%]
tests/unit/agent/cache/test_dependency_graph.py::TestToolDependencyGraph::test_complex_dependency_chain PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestStartupShutdown::test_initial_state PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestStartupShutdown::test_start_watcher PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestStartupShutdown::test_stop_watcher PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestStartupShutdown::test_multiple_starts PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestStartupShutdown::test_multiple_stops PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestSingleFileWatching::test_watch_file PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestSingleFileWatching::test_detect_file_modification PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestSingleFileWatching::test_watch_nonexistent_file PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestSingleFileWatching::test_unwatch_file PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestDirectoryWatching::test_watch_directory PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestDirectoryWatching::test_watch_directory_recursive PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestDirectoryWatching::test_detect_file_in_directory PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestDirectoryWatching::test_detect_file_in_subdirectory_recursive PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestDirectoryWatching::test_unwatch_directory PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestFileChangeEvents::test_file_created_event PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestFileChangeEvents::test_file_deleted_event PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestFileChangeEvents::test_file_moved_event PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestEventRetrieval::test_get_changes_returns_empty_initially PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestEventRetrieval::test_get_changes_consumes_events PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestEventRetrieval::test_multiple_changes_accumulate PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestThreadSafety::test_concurrent_watch_operations PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestThreadSafety::test_concurrent_get_changes PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestErrorHandling::test_watch_nonexistent_directory PASSED [  0%]
tests/unit/agent/cache/test_file_watcher.py::TestErrorHandling::test_operations_when_not_running PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_init PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_init_without_dependency_tracking PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_get_tool_result_miss PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_set_and_get_tool_result PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_set_with_file_dependencies PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_set_with_dependent_tools PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_tool PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_tool_with_cascade PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_file_dependencies PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_clear_all PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_get_stats PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_custom_ttl PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_different_namespaces_isolated PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_tool_specific_namespace PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_make_cache_key PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_hash_args_stable PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace_recursive PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace_recursive_session PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace_recursive_tool PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace_empty PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace_recursive_empty PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_get_child_namespaces PASSED [  0%]
tests/unit/agent/cache/test_tool_cache_manager.py::TestToolCacheManager::test_invalidate_namespace_non_recursive_does_not_clear_children PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_create_valid_spec PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_spec_defaults PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_spec_frozen PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_empty_name_raises_error PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_empty_method_name_raises_error PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_invalid_version_format_raises_error PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_version_missing_minor_raises_error PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_version_negative_numbers_raises_error PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilitySpec::test_valid_version_formats PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilityBase::test_cannot_instantiate_base_class PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilityBase::test_subclass_must_implement_get_spec PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilityBase::test_valid_subclass PASSED [  0%]
tests/unit/agent/capabilities/test_base.py::TestCapabilityBase::test_multiple_subclasses PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_enabled_tools_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_tool_dependencies_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_tool_sequences_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_tiered_tool_config_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_vertical_middleware_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_vertical_safety_patterns_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_vertical_context_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_rl_hooks_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_team_specs_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_mode_configs_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_default_budget_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_custom_prompt_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_prompt_section_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_task_type_hints_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_safety_patterns_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilities::test_enrichment_strategy_capability PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilityNames::test_all_capabilities_have_names PASSED [  0%]
tests/unit/agent/capabilities/test_builtin.py::TestBuiltinCapabilityNames::test_all_capabilities_have_valid_versions PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityRegistryIntegration::test_get_capability_registry PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityRegistryIntegration::test_get_method_for_capability_integration PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityRegistryIntegration::test_get_method_for_unknown_capability PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityRegistryIntegration::test_backward_compatibility_with_legacy_dict PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityRegistryIntegration::test_registry_has_all_legacy_capabilities PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityRegistryIntegration::test_dynamic_capability_registration_affects_global_registry PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestCapabilityMethodMappings::test_all_capability_mappings_match_registry PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestErrorHandling::test_registry_survives_invalid_entry_point PASSED [  0%]
tests/unit/agent/capabilities/test_integration.py::TestErrorHandling::test_method_resolution_with_mixed_sources PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_registry_initialization PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_get_method_for_builtin_capability PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_get_method_for_unknown_capability_fallback PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_has_capability_for_builtin PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_has_capability_for_unknown PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_get_capability PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_get_capability_unknown PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_list_capabilities PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_register_capability_at_runtime PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_register_capability_override PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_unregister_capability PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_unregister_unknown_capability PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistry::test_get_registry_stats PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistryWithEntryPoints::test_entry_points_loaded_flag PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestDynamicCapabilityRegistryWithEntryPoints::test_builtin_capabilities_always_available PASSED [  0%]
tests/unit/agent/capabilities/test_registry.py::TestCustomCapabilityClass::test_custom_capability_class PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestBaseAnalyticsExporter::test_exporter_type PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestBaseAnalyticsExporter::test_export_raises_not_implemented PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestConsoleAnalyticsExporter::test_init_default PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestConsoleAnalyticsExporter::test_init_verbose PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestConsoleAnalyticsExporter::test_export PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestConsoleAnalyticsExporter::test_export_verbose PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_init_json_format PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_init_csv_format PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_init_invalid_format PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_init_no_append PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_export_json_new_file PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_export_json_append PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_export_csv_new_file PASSED [  0%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_export_csv_append PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_export_creates_directory PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestFileAnalyticsExporter::test_export_with_nested_data PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_init_empty PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_init_with_exporters PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_track_event PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_track_multiple_events PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_export_analytics_no_session PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_export_analytics_no_exporters PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_export_analytics_success PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_export_analytics_specific_exporters PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_export_analytics_handles_errors PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_query_analytics_all PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_query_analytics_by_session PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_query_analytics_by_event_type PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_query_analytics_with_limit PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_get_session_stats_not_found PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_get_session_stats PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_add_exporter PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_add_duplicate_exporter PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_remove_exporter PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_remove_nonexistent_exporter PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_clear_session PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_clear_all_sessions PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_track_event_updates_timestamp PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_export_to_multiple_exporters PASSED [  1%]
tests/unit/agent/coordinators/test_analytics_coordinator.py::TestAnalyticsCoordinator::test_query_analytics_filters_by_time PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorInitialization::test_initialization PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_simple_response FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_token_usage_tracking FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_tool_calls FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_empty_response_uses_completer FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_max_iterations_exceeded FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_thinking_enabled FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_context_compaction FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_tool_failure_uses_completer FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorStreamChat::test_stream_chat_yields_chunks PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorStreamChat::test_stream_chat_updates_cumulative_token_usage PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorStreamChat::test_stream_chat_cancellation_handling PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_classify_task_keywords_analysis PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_classify_task_keywords_action PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_classify_task_keywords_execution PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_classify_task_keywords_default PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_extract_required_files_from_prompt PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_extract_required_outputs_from_prompt PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_get_max_context_chars PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorHelperMethods::test_parse_and_validate_tool_calls PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRateLimitRetry::test_get_rate_limit_wait_time PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRateLimitRetry::test_get_rate_limit_wait_time_capped PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_create_recovery_context PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_apply_recovery_action_force_summary PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_apply_recovery_action_retry PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_apply_recovery_action_finalize PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_apply_recovery_action_continue PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_handle_empty_response_recovery_success PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorRecoveryMethods::test_handle_empty_response_recovery_failure PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_handle_cancellation_detected PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_handle_cancellation_not_detected PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_check_progress_making_progress PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_check_progress_not_making_progress PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_handle_force_completion_with_handler_analysis_task PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_handle_force_completion_with_handler_action_task PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorDelegationMethods::test_handle_force_completion_not_triggered PASSED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorEdgeCases::test_chat_completer_fails_uses_fallback FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorEdgeCases::test_chat_with_tool_failures_uses_format_message FAILED [  1%]
tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorEdgeCases::test_chat_provider_exception_propagates FAILED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_checkpoint_manager_property PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_checkpoint_manager_property_when_disabled PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_is_enabled_when_manager_exists PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_is_enabled_when_manager_is_none PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_with_description PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_with_tags PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_without_description PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_when_disabled PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_with_serialization_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_with_value_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_uses_session_id PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_save_checkpoint_with_empty_tags PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_success PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_when_disabled PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_with_os_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_with_io_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_with_key_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_with_value_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_restore_checkpoint_applies_state_correctly PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_maybe_auto_checkpoint_creates_checkpoint PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_maybe_auto_checkpoint_returns_none_when_not_needed PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_maybe_auto_checkpoint_when_disabled PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_maybe_auto_checkpoint_with_serialization_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_maybe_auto_checkpoint_with_value_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_maybe_auto_checkpoint_uses_session_id PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_update_session_id PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_update_session_id_to_none PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_update_session_id_affects_subsequent_saves PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_checkpoint_workflow_save_and_restore PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_multiple_checkpoints_same_session PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinator::test_auto_checkpoint_after_tool_execution PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_save_checkpoint_propagates_get_state_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_restore_checkpoint_propagates_apply_state_error PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_save_checkpoint_with_complex_state PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_save_checkpoint_with_special_characters_in_description PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_restore_checkpoint_with_empty_checkpoint_id PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_restore_checkpoint_with_special_characters_in_id PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_rapid_auto_checkpoint_calls PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_session_update_between_operations PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_multiple_restores_in_sequence PASSED [  1%]
tests/unit/agent/coordinators/test_checkpoint_coordinator.py::TestCheckpointCoordinatorEdgeCases::test_save_and_restore_cycle PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestSettingsConfigProvider::test_get_config PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestSettingsConfigProvider::test_priority PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestEnvironmentConfigProvider::test_get_config_from_env PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestEnvironmentConfigProvider::test_get_config_empty_env PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_init_empty PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_init_with_providers PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_init_sorts_providers_by_priority PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_load_config_no_providers PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_load_config_merges_providers PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_load_config_with_override PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_load_config_caching PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_invalidate_cache PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_invalidate_all_cache PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_load_orchestrator_config PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_validate_config_valid PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_validate_config_missing_required_fields PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_validate_config_invalid_temperature PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_validate_config_invalid_max_tokens PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_validate_config_warnings PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_validate_orchestrator_config PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_add_provider PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_add_provider_resorts PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_remove_provider PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_remove_nonexistent_provider PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinator::test_deep_merge PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestValidationResult::test_validation_result_success PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestValidationResult::test_validation_result_with_errors PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestValidationResult::test_validation_result_with_warnings PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestValidationResult::test_validation_result_with_metadata PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestOrchestratorConfig::test_orchestrator_config_defaults PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestOrchestratorConfig::test_orchestrator_config_custom_values PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestProfileConfigProvider::test_get_config_from_profile PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestProfileConfigProvider::test_get_config_profile_not_found PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestProfileConfigProvider::test_get_config_profile_not_found_with_suggestions PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestProfileConfigProvider::test_priority PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinatorErrorHandling::test_load_config_provider_error PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinatorErrorHandling::test_load_config_no_providers_returns_empty PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinatorErrorHandling::test_load_config_with_failing_and_working_providers PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinatorCreateProvider::test_create_provider_missing_provider_field PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinatorCreateProvider::test_create_provider_with_mock_registry PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestConfigCoordinatorCreateProvider::test_create_provider_with_profile_overrides PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_init PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_init_with_none_components PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_build_tool_access_context PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_build_tool_access_context_defaults PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_get_enabled_tools_with_controller PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_get_enabled_tools_without_controller PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_is_tool_enabled_with_controller PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_is_tool_enabled_without_controller PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_set_enabled_tools PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_set_enabled_tools_with_vertical_context PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_get_available_tools PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_get_available_tools_no_registry PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_detect_config_changes PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_detect_config_changes_no_changes PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_validate_mode_transition_safe PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_validate_mode_transition_restrictive_with_warnings PASSED [  1%]
tests/unit/agent/coordinators/test_config_coordinator.py::TestToolAccessConfigCoordinator::test_validate_mode_transition_restrictive_no_write_tools PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestBaseCompactionStrategy::test_can_apply_within_budget PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestBaseCompactionStrategy::test_can_apply_exceeds_budget PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestBaseCompactionStrategy::test_compact_raises_not_implemented PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestBaseCompactionStrategy::test_estimated_savings PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestTruncationCompactionStrategy::test_init_default PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestTruncationCompactionStrategy::test_init_custom_reserve PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestTruncationCompactionStrategy::test_compact_removes_oldest_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestTruncationCompactionStrategy::test_compact_preserves_reserved_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestTruncationCompactionStrategy::test_compact_calculates_tokens_saved PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestTruncationCompactionStrategy::test_estimated_savings PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_init_empty PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_init_with_strategies PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_compact_context_within_budget PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_compact_context_exceeds_budget PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_compact_context_uses_first_applicable_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_compact_context_no_applicable_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_compact_context_handles_strategy_errors PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_rebuild_context PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_estimate_token_count_from_context PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_estimate_token_count_from_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_is_within_budget_true PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_is_within_budget_false PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_is_within_budget_default_max_tokens PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_add_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_remove_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_remove_nonexistent_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_get_compaction_history PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_clear_compaction_history PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinator::test_compact_context_records_history PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_init_default PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_init_custom_params PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_can_apply_within_threshold PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_can_apply_exceeds_threshold PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_compact_summarizes_old_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_compact_preserves_recent_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_compact_not_enough_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSummarizationCompactionStrategy::test_estimated_savings PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_init_default PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_init_custom_params PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_can_apply_exceeds_budget PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_compact_removes_similar_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_compact_preserves_recent_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_compact_not_enough_messages PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestSemanticCompactionStrategy::test_estimated_savings PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_init_default PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_init_custom_params PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_init_creates_sub_strategies PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_can_apply_exceeds_budget PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_compact_uses_semantic_first PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_compact_falls_back_to_truncation PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_compact_stops_early_if_successful PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_compact_calculates_total_savings PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestHybridCompactionStrategy::test_estimated_savings PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinatorWithNewStrategies::test_coordinator_uses_summarization_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinatorWithNewStrategies::test_coordinator_uses_semantic_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinatorWithNewStrategies::test_coordinator_uses_hybrid_strategy PASSED [  1%]
tests/unit/agent/coordinators/test_context_coordinator.py::TestContextCoordinatorWithNewStrategies::test_coordinator_strategy_priority_order PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_messages_property_returns_conversation_messages PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_messages_property_returns_empty_list_when_no_messages PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_delegates_to_conversation PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_user_role PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_assistant_role PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_system_role PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_empty_content PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_long_content PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_special_characters PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_persists_to_memory_manager_when_enabled PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_does_not_persist_to_memory_manager_when_disabled PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_memory_manager_disabled PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_logs_user_prompt_to_usage_analytics PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_logs_assistant_response_to_usage_analytics PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_does_not_log_system_messages PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_without_usage_logger PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_add_message_with_memory_and_logging PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_reset_conversation_delegates_to_lifecycle_manager PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_reset_conversation_clears_all_state PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_reset_conversation_multiple_calls PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_conversation_flow_add_and_reset PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_multiple_messages_same_role PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinator::test_message_order_preserved PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinatorEdgeCases::test_add_message_with_none_conversation_raises_error PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinatorEdgeCases::test_add_message_with_unicode_content PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinatorEdgeCases::test_add_message_with_newlines_and_tabs PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinatorEdgeCases::test_messages_property_with_conversation_that_raises PASSED [  1%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinatorEdgeCases::test_add_message_when_conversation_raises PASSED [  2%]
tests/unit/agent/coordinators/test_conversation_coordinator.py::TestConversationCoordinatorEdgeCases::test_reset_conversation_when_lifecycle_manager_raises PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorInit::test_init_with_all_dependencies PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorInit::test_init_with_minimal_dependencies PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorInit::test_init_event_publishing_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_get_event_bus_when_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_get_event_bus_lazy_loading PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_get_event_bus_import_error_disables_publishing PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_publish_event_when_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_publish_event_with_no_event_bus PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_publish_event_success PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEventBus::test_publish_event_handles_exceptions PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorUsageAnalytics::test_usage_analytics_property_returns_analytics PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorUsageAnalytics::test_usage_analytics_property_returns_none PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorRecordIntelligentOutcome::test_record_intelligent_outcome_success PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorRecordIntelligentOutcome::test_record_intelligent_outcome_with_no_integration PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorRecordIntelligentOutcome::test_record_intelligent_outcome_with_default_parameters PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorRecordIntelligentOutcome::test_record_intelligent_outcome_handles_exception PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorRecordIntelligentOutcome::test_record_intelligent_outcome_publishes_event PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorRecordIntelligentOutcome::test_record_intelligent_outcome_with_stuck_loop_detected PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_success PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_with_error PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_with_cancelled_session PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_with_no_rl_coordinator PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_quality_score_fast_response PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_quality_score_slow_response PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_with_vertical_context PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_publishes_event PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_handles_import_error PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorSendRLRewardSignal::test_send_rl_reward_signal_handles_attribute_error PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_with_all_components PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_with_no_components PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_with_usage_analytics_failure PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_with_sequence_tracker_failure PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_publishes_event PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_records_duration PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorFlushAnalytics::test_flush_analytics_partial_success PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorIntegrationScenarios::test_complete_evaluation_workflow PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorIntegrationScenarios::test_workflow_with_missing_dependencies PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorIntegrationScenarios::test_workflow_with_event_publishing_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEdgeCases::test_record_outcome_with_zero_quality_score PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEdgeCases::test_record_outcome_with_max_quality_score PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEdgeCases::test_send_rl_reward_signal_with_missing_session_attributes PASSED [  2%]
tests/unit/agent/coordinators/test_evaluation_coordinator.py::TestEvaluationCoordinatorEdgeCases::test_flush_analytics_concurrent_calls PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_initialization PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_extract_requirements PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_extract_empty_requirements PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_mark_observed_single PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_mark_observed_multiple PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_set_observed_files PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_required_files_get_set PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_required_outputs_get_set PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_read_session_operations PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_nudge_sent_get_set PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_are_all_required_files_observed PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_are_all_required_files_observed_empty PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_get_missing_files PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_get_file_observation_progress PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_get_file_observation_progress_empty PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_get_state PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_set_state PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_set_state_partial PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestFileContextCoordinator::test_reset PASSED [  2%]
tests/unit/agent/coordinators/test_file_context_coordinator.py::TestCreateFileContextCoordinator::test_factory_function PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_initialization PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_initialization_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_prepare_intelligent_request PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_prepare_intelligent_request_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_prepare_intelligent_request_no_qlearning PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_prepare_intelligent_request_exception PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_validate_intelligent_response PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_validate_with_expected_outcomes PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_validate_no_evaluation_coordinator PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_validate_exception PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_record_intelligent_outcome PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_record_outcome_no_metadata PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_record_outcome_no_evaluation_coordinator PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_record_outcome_exception PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_preload_embeddings_already_loaded PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_preload_embeddings_no_project_path PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_preload_embeddings_exception SKIPPED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_get_state PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_get_state_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_reset PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_is_intelligent_enabled PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_is_intelligent_enabled_false PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_is_qlearning_enabled PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_is_qlearning_enabled_false PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestIntelligentFeatureCoordinator::test_are_embeddings_preloaded PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestCreateIntelligentFeatureCoordinator::test_factory_function PASSED [  2%]
tests/unit/agent/coordinators/test_intelligent_feature_coordinator.py::TestCreateIntelligentFeatureCoordinator::test_factory_function_with_coordinators PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_initialization PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_initialization_with_components PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_memory_context_with_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_memory_context_without_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_memory_context_with_exception PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_session_stats_with_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_session_stats_without_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_session_stats_session_not_found PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_session_stats_with_exception PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_recent_sessions_with_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_recent_sessions_without_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_recent_sessions_with_exception PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_recover_session_success PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_recover_session_failure PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_recover_session_without_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_recover_session_with_exception PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_set_session_id PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_clear_session_id PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_is_enabled_true PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_is_enabled_no_manager PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_is_enabled_no_session PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_in_memory_messages_success PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_in_memory_messages_no_store PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestMemoryCoordinator::test_get_in_memory_messages_with_exception PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestCreateMemoryCoordinator::test_factory_with_defaults PASSED [  2%]
tests/unit/agent/coordinators/test_memory_coordinator.py::TestCreateMemoryCoordinator::test_factory_with_all_components PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingState::test_initial_state PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingState::test_reset_clears_all_state PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinator::test_initialization PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinator::test_factory_function_creates_coordinator PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinator::test_factory_function_with_custom_token_usage PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_finalize_stream_metrics_with_valid_metrics PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_finalize_stream_metrics_with_usage_data PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_finalize_stream_metrics_with_none_result PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_get_last_stream_metrics PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_get_streaming_metrics_summary PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_get_streaming_metrics_history PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamMetrics::test_get_streaming_metrics_history_with_custom_limit PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestCostTracking::test_get_session_cost_summary PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestCostTracking::test_get_session_cost_formatted PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestCostTracking::test_export_session_costs_json PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestCostTracking::test_export_session_costs_csv PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestCostTracking::test_export_session_costs_default_format PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_get_token_usage PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_get_token_usage_with_zero_tokens PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_get_token_usage_with_large_counts PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_reset_token_usage PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_update_cumulative_token_usage PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_update_cumulative_token_usage_partial_data PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_update_cumulative_token_usage_with_cache_tokens PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestTokenUsage::test_token_usage_tracking_flow PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestToolUsageStats::test_get_tool_usage_stats PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestToolUsageStats::test_get_tool_usage_stats_with_conversation_summary PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_record_tool_selection PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_record_tool_execution PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_on_tool_start PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_on_tool_complete PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_on_streaming_session_complete PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_record_first_token PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_init_stream_metrics PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_update_model_info PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_reset_stats PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_metrics_collector_property PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCollectorDelegation::test_session_cost_tracker_property PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_start_streaming_initializes_state PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_start_streaming_creates_new_cancel_event PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_stop_streaming_clears_state PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_is_streaming_returns_false_initially PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_is_streaming_returns_true_when_active PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_is_streaming_returns_false_after_stopping PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_request_cancellation_when_streaming PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_request_cancellation_when_not_streaming PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_request_cancellation_with_no_event PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_is_cancellation_requested_returns_false_initially PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_is_cancellation_requested_returns_true_after_request PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_is_cancellation_requested_returns_false_after_stopping PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_get_session_elapsed_time_returns_zero_when_not_streaming PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_get_session_elapsed_time_returns_elapsed_seconds PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_get_session_elapsed_time_after_stopping PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_cancel_event_property_returns_none_initially PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_cancel_event_property_returns_event_when_streaming PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_cancel_event_property_returns_none_after_stopping PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestStreamingStateManagement::test_complete_streaming_lifecycle PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinatorIntegration::test_complete_streaming_session_workflow PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinatorIntegration::test_token_usage_tracking_across_session PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinatorIntegration::test_metrics_collection_with_cancellation PASSED [  2%]
tests/unit/agent/coordinators/test_metrics_coordinator.py::TestMetricsCoordinatorIntegration::test_export_and_format_cost_workflow PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_initialization PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_middleware PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_middleware_returns_copy PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_middleware_empty PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_safety_patterns PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_safety_patterns_returns_copy PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_safety_patterns_empty PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_get_middleware_chain_initially_none PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_middleware_chain PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_build_middleware_chain_empty PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_build_middleware_chain_with_middleware PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_code_correction_middleware PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_get_code_correction_middleware_initially_none PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_vertical_middleware_storage PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_middleware_chain_storage PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_set_safety_patterns_storage PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_get_state PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_get_state_empty PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_reset PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_has_middleware PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_has_safety_patterns PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_has_code_correction PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_get_middleware_summary PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestMiddlewareCoordinator::test_get_middleware_summary_empty PASSED [  2%]
tests/unit/agent/coordinators/test_middleware_coordinator.py::TestCreateMiddlewareCoordinator::test_factory_function PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_current_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_mode_config PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_is_tool_allowed_build_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_is_tool_allowed_plan_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_is_tool_allowed_explore_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_tool_priority PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_tool_priority_default PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_exploration_multiplier PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_exploration_multiplier_plan_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_switch_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_switch_to_same_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_mode_status PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_resolve_shell_variant_build_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_resolve_shell_variant_plan_mode PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_system_prompt_addition PASSED [  2%]
tests/unit/agent/coordinators/test_mode_coordinator.py::TestModeCoordinator::test_get_available_modes PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestVerticalPromptContributor::test_contribute_returns_prompt_for_matching_vertical PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestVerticalPromptContributor::test_contribute_returns_empty_for_non_matching_vertical PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestVerticalPromptContributor::test_contribute_handles_empty_context PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestVerticalPromptContributor::test_contribute_handles_context_without_vertical PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestVerticalPromptContributor::test_priority_returns_correct_value PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestVerticalPromptContributor::test_default_priority_is_100 PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_contribute_with_callable_handler PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_contribute_with_static_string_handler PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_contribute_aggregates_multiple_handlers PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_contribute_skips_missing_context_keys PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_contribute_handles_handler_exceptions PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_contribute_returns_empty_for_empty_context PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_add_handler_adds_new_handler PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_remove_handler_removes_existing_handler PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_remove_handler_handles_missing_key PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestContextPromptContributor::test_priority_returns_correct_value PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_contribute_loads_project_context PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_contribute_returns_empty_when_disabled PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_contribute_returns_empty_when_no_project_file PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_contribute_caches_content PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_invalidate_cache_clears_cached_content PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_priority_returns_correct_value PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestProjectInstructionsContributor::test_contribute_handles_loading_errors PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_contribute_returns_prompt_for_matching_mode PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_contribute_returns_empty_for_non_matching_mode PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_contribute_handles_empty_context PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_contribute_handles_context_without_mode PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_set_mode_prompt_adds_new_mode PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_set_mode_prompt_updates_existing_mode PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_get_supported_modes_returns_all_modes PASSED [  2%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestModeAwareContributor::test_priority_returns_correct_value PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestStageAwareContributor::test_contribute_returns_prompt_for_matching_stage PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestStageAwareContributor::test_contribute_returns_empty_for_non_matching_stage PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestStageAwareContributor::test_contribute_handles_empty_context PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestStageAwareContributor::test_set_stage_prompt_adds_new_stage PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestStageAwareContributor::test_get_supported_stages_returns_all_stages PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestStageAwareContributor::test_priority_returns_correct_value PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_contribute_with_async_function PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_contribute_with_sync_function PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_contribute_returns_empty_for_non_callable PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_contribute_handles_function_returning_none PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_contribute_propagates_exceptions PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_contribute_passes_context_to_function PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestDynamicPromptContributor::test_priority_returns_correct_value PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestPromptContributorIntegration::test_multiple_contributors_with_priorities PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestPromptContributorIntegration::test_contributors_with_empty_contributions PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_contributors.py::TestPromptContributorIntegration::test_dynamic_and_static_contributors PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestBasePromptContributor::test_contribute_returns_empty_string PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestBasePromptContributor::test_priority PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestSystemPromptContributor::test_contribute PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestSystemPromptContributor::test_priority PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestTaskHintContributor::test_contribute PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestTaskHintContributor::test_contribute_unknown_task PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestTaskHintContributor::test_set_hint PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_init_empty PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_init_with_contributors PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_init_sorts_contributors_by_priority PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_system_prompt_no_contributors PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_system_prompt_merges_contributions PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_system_prompt_order_by_priority PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_system_prompt_caching PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_invalidate_cache PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_task_hint PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_task_hint_empty_context PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_task_hint_caches_by_task_type PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_invalidate_all_cache PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_add_contributor PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_add_contributor_resorts PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_remove_contributor PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_make_cache_key PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_contributor_error_handling PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_cache_ttl_expiration PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_cache_disabled PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_get_cache_stats PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_reset_cache_stats PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_make_cache_key_with_unjsonifiable_context PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_task_hint_with_error PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_task_hint_all_failing PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_build_system_prompt_multiple_contributors_with_errors PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_invalidate_cache_specific_context PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_remove_nonexistent_contributor PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptCoordinator::test_empty_prompt_not_cached PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_init PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_init_with_tool_calling_caps PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_build_system_prompt_with_adapter_small_context PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_build_system_prompt_with_adapter_large_context PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_build_system_prompt_with_adapter_emits_rl_event_when_enabled PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_build_system_prompt_with_adapter_rl_hooks_unavailable PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_build_system_prompt_with_adapter_rl_event_failure PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_emit_prompt_used_event_detects_local_provider PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_emit_prompt_used_event_detects_cloud_provider PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_emit_prompt_used_event_analyzes_prompt_content PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_emit_prompt_used_event_disabled PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_get_thinking_disabled_prompt_with_prefix PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_get_thinking_disabled_prompt_without_prefix PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_get_thinking_disabled_prompt_no_attribute PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestPromptBuilderCoordinator::test_set_tool_calling_caps PASSED [  3%]
tests/unit/agent/coordinators/test_prompt_coordinator.py::TestIPromptBuilderCoordinator::test_protocol_methods_exist PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorInit::test_init_with_default_config PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorInit::test_init_with_custom_config PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorInit::test_init_post_switch_hooks_initialized_empty PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorProperties::test_provider_property PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorProperties::test_model_property PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorProperties::test_provider_name_property PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorProperties::test_tool_adapter_property PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorProperties::test_capabilities_property PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorProperties::test_switch_count_property PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_provider_success PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_provider_with_custom_kwargs PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_provider_uses_current_model_when_not_specified PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_provider_failure_returns_false PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_provider_exception_handling PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_model_success PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_model_failure_returns_false PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_switch_model_exception_handling PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderSwitching::test_get_current_provider_info PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestHealthMonitoring::test_start_health_monitoring PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestHealthMonitoring::test_stop_health_monitoring PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestHealthMonitoring::test_get_provider_health_with_no_provider PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestHealthMonitoring::test_get_provider_health_with_healthy_provider PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestHealthMonitoring::test_get_provider_health_with_unhealthy_provider PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestHealthMonitoring::test_get_healthy_providers PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_with_retry_after_attribute PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_with_retry_after_exceeding_max PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_with_invalid_retry_after PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_from_error_message_try_again PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_from_error_message_retry_after PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_from_error_message_wait PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_from_error_message_seconds_at_end PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_from_error_message_just_number PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_from_response_headers PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_wait_time_fallback_to_default PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_track_rate_limit_increments_count PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_track_rate_limit_multiple_times PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimiting::test_get_rate_limit_stats PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestCapabilityDiscovery::test_discover_capabilities_success PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestCapabilityDiscovery::test_discover_capabilities_caches_result PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestCapabilityDiscovery::test_discover_capabilities_with_custom_provider_and_model PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestCapabilityDiscovery::test_discover_capabilities_falls_back_to_config_on_error PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestCapabilityDiscovery::test_discover_capabilities_returns_none_when_no_provider PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestPostSwitchHooks::test_register_post_switch_hook PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestPostSwitchHooks::test_notify_post_switch_hooks_calls_all_hooks PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestPostSwitchHooks::test_notify_post_switch_hooks_handles_exceptions PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestPostSwitchHooks::test_notify_post_switch_hooks_with_no_state PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestLifecycle::test_close_stops_health_monitoring PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestLifecycle::test_close_closes_provider_manager PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestFactoryFunction::test_create_provider_coordinator PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestFactoryFunction::test_create_provider_coordinator_with_custom_config PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimitInfo::test_rate_limit_info_creation PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestRateLimitInfo::test_rate_limit_info_defaults PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorConfig::test_config_with_defaults PASSED [  3%]
tests/unit/agent/coordinators/test_provider_coordinator.py::TestProviderCoordinatorConfig::test_config_with_custom_values PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestProcessedResponse::test_default_values PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestProcessedResponse::test_has_tool_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestProcessedResponse::test_is_empty PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestChunkProcessResult::test_default_values PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestToolCallValidationResult::test_default_values PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorConfig::test_default_config PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorConfig::test_custom_config PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_init PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_sanitize_response PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_sanitize_response_disabled PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_is_garbage_content PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_is_valid_tool_name PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_parse_and_validate_tool_calls_no_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_parse_and_validate_tool_calls_with_filtering PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_normalize_tool_call_arguments PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_normalize_tool_call_arguments_literal_eval PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_normalize_tool_call_arguments_none PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_process_stream_chunk_valid_content PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_process_stream_chunk_garbage_content PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_process_stream_chunk_max_garbage_reached PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_process_stream_chunk_reset_on_valid PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_aggregate_chunks PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_aggregate_chunks_empty PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_aggregate_stream_chunks PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_is_content_meaningful PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinator::test_format_response_for_display PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorIntegration::test_full_response_processing_workflow PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_aggregate_stream_chunks_default_attr PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_aggregate_stream_chunks_custom_attr PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_aggregate_stream_chunks_empty PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_aggregate_stream_chunks_no_content_attr PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_extract_remaining_content_no_tool_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_extract_remaining_content_with_tool_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_extract_remaining_content_empty PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_normalize_tool_call_arguments_invalid_string PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_parse_and_validate_tool_calls_no_adapter PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_parse_and_validate_tool_calls_non_dict_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_parse_and_validate_tool_calls_empty_enabled_tools PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_process_stream_chunk_no_content_attr PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_process_stream_chunk_empty_content PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_try_extract_tool_calls_disabled PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_is_garbage_content_empty PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_sanitize_response_empty PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_format_response_for_display_no_tool_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorExtendedMethods::test_format_response_for_display_tool_calls_no_name PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_resolve_shell_variant_internal PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_resolve_shell_variant_internal_not_shell_alias PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_resolve_shell_variant_internal_no_resolver PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_is_tool_enabled_internal_with_set PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_is_tool_enabled_internal_with_checker PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_is_tool_enabled_internal_with_registry PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_is_tool_enabled_internal_registry_error PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_is_tool_enabled_internal_no_fallbacks PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_parse_and_validate_with_resolution_shell_alias PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_parse_and_validate_with_resolution_filters_disabled PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_parse_and_validate_with_resolution_no_tool_calls PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorWithResolution::test_parse_and_validate_with_resolution_normalizes_arguments PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_is_content_meaningful_whitespace_only PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_is_content_meaningful_custom_threshold PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_aggregate_chunks_all_none PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_aggregate_chunks_with_empty_strings PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_parse_and_validate_tool_calls_all_filtered PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_process_stream_chunk_already_garbage_detected PASSED [  3%]
tests/unit/agent/coordinators/test_response_coordinator.py::TestResponseCoordinatorEdgeCases::test_process_stream_chunk_exactly_max_garbage PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_returns_keyword_tool PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_returns_semantic_tool PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_returns_both_tools_for_hybrid PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_with_transformed_query PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_with_empty_patterns PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_with_multiple_patterns PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_with_varying_confidence PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_delegates_to_router PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_handles_special_characters PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_handles_unicode PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_route_search_query_with_long_query PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_returns_keyword PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_returns_semantic PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_returns_both_for_hybrid PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_convenience_method PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_calls_route_search_query PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_with_empty_query PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_search_tool_with_whitespace PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_tool_mapping_covers_all_search_types PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_coordinator_initialization_with_search_router PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_coordinator_requires_search_router PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_multiple_queries_same_coordinator PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinator::test_get_recommended_tool_multiple_calls PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_route_search_query_with_none_router PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_route_search_query_when_router_raises_exception PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_route_search_query_with_unmapped_search_type PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_get_recommended_tool_when_router_raises PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_route_search_query_preserves_all_route_fields PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_route_search_query_with_newlines_in_query PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_route_search_query_with_tabs_in_query PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorEdgeCases::test_concurrent_route_calls PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorToolMapping::test_tool_map_is_complete PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorToolMapping::test_tool_map_values PASSED [  3%]
tests/unit/agent/coordinators/test_search_coordinator.py::TestSearchCoordinatorToolMapping::test_tool_map_is_class_attribute PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionInfo::test_default_initialization PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionInfo::test_custom_initialization PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionInfo::test_to_dict PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionInfo::test_from_dict PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionInfo::test_from_dict_with_defaults PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCostSummary::test_default_initialization PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCostSummary::test_custom_initialization PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCostSummary::test_to_dict PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_initialization_with_required_dependencies PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_initialization_with_all_dependencies PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_create_session_generates_session_id PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_create_session_with_custom_session_id PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_create_session_resets_session_state PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_create_session_with_memory_manager PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_create_session_memory_manager_failure PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_end_session_marks_inactive PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_end_session_with_memory_manager PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_end_session_without_current_session PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_end_session_memory_manager_failure PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_reset_session PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_reset_session_preserve_token_usage PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_reset_session_without_lifecycle_manager PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_reset_session_updates_activity_timestamp PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_recover_session_success PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_recover_session_without_memory_manager PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_recover_session_failure PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_session_id_property PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_memory_session_id_property PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_session_state_property PASSED [  3%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_is_active_property PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_tool_calls_used_property PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_remaining_budget_property PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_is_budget_exhausted_property PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_info PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_stats PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_stats_with_memory_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_stats_memory_manager_failure PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_summary PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_cost_summary PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_cost_summary_with_tracker PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_cost_formatted PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_session_cost_formatted_with_tracker PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_save_checkpoint_success PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_save_checkpoint_without_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_save_checkpoint_io_error PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_save_checkpoint_serialization_error PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_restore_checkpoint_success PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_restore_checkpoint_without_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_restore_checkpoint_io_error PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_restore_checkpoint_invalid_data PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_maybe_auto_checkpoint PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_maybe_auto_checkpoint_without_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_maybe_auto_checkpoint_error_handling PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_checkpoint_state PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_apply_checkpoint_state PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_recent_sessions_success PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_recent_sessions_without_memory_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_recent_sessions_with_limit PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_recent_sessions_handles_message_count PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_recent_sessions_error_handling PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_token_usage PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_update_token_usage PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_update_token_usage_with_defaults PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_reset_token_usage PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_memory_context_with_memory_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_memory_context_without_memory_manager PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_memory_context_with_fallback PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_memory_context_converts_message_objects PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_memory_context_without_session PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_get_memory_context_empty_fallback PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_repr PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinator::test_repr_without_session PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestCreateSessionCoordinatorFactory::test_factory_with_required_dependencies PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestCreateSessionCoordinatorFactory::test_factory_with_all_dependencies PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinatorIntegration::test_complete_session_lifecycle PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinatorIntegration::test_session_reset_flow PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinatorIntegration::test_multiple_sessions_sequential PASSED [  4%]
tests/unit/agent/coordinators/test_session_coordinator.py::TestSessionCoordinatorIntegration::test_checkpoint_restore_flow PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateScope::test_scope_values PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateChange::test_state_change_creation PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateChange::test_state_change_with_changes PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateChange::test_to_dict PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_init PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_init_without_conversation_state PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_all_scopes PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_session_only PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_without_metadata PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_set_state PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_transition_to PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_transition_to_without_conversation_state PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_transition_to_string PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_stage PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_stage_without_conversation_state PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_stage_tools PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_session_state_delegation_properties PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_tool_budget_property PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_tool_budget_setter PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_is_budget_exhausted PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_remaining_budget PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_record_tool_call PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_increment_tool_calls PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_record_file_read PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_subscribe PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_unsubscribe PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_unsubscribe_all PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_on_state_change_decorator PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_history PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_history_with_limit PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_changes_count PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_clear_state_history PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_get_state_summary PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestStateCoordinator::test_repr PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestCreateStateCoordinator::test_create_basic PASSED [  4%]
tests/unit/agent/coordinators/test_state_coordinator_new.py::TestCreateStateCoordinator::test_create_with_all_params PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_delegates_to_mw_coordinator PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_with_different_task_types PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_with_different_complexity_levels PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_with_different_modes PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_returns_coordination_suggestion PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_includes_team_recommendations PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_with_empty_recommendations PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_suggestions_passes_correct_mode_from_coordinator PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_set_team_specs_stores_in_orchestrator PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_set_team_specs_with_empty_dict PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_set_team_specs_with_single_team PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_set_team_specs_overrides_existing_specs PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_set_team_specs_with_multiple_teams PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_set_team_specs_preserves_spec_reference PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_specs_returns_stored_specs PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_specs_returns_empty_dict_when_not_set PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_specs_returns_same_reference PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_specs_after_set_team_specs PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_get_team_specs_does_not_modify_original PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_full_workflow_set_get_suggestions PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_multiple_set_and_get_cycles PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinator::test_team_spec_isolation_between_coordinators PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_suggestions_with_none_task_type PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_suggestions_with_none_complexity PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_suggestions_with_empty_strings PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_suggestions_when_mw_coordinator_raises PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_set_team_specs_with_none PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_specs_when_specs_is_none PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_specs_with_special_characters_in_team_names PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_get_team_suggestions_with_unicode_task_type PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_set_team_specs_with_large_number_of_teams PASSED [  4%]
tests/unit/agent/coordinators/test_team_coordinator.py::TestTeamCoordinatorEdgeCases::test_multiple_suggestions_with_different_params PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorInit::test_init_with_default_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorInit::test_init_with_custom_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorInit::test_init_with_mode_controller PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorInit::test_init_without_tool_registry PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_registered_tool_default_allow PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_unregistered_tool_default_allow PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_unregistered_tool_strict_mode PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_unregistered_tool_no_default_allow PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_with_session_enabled_tools PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_with_mode_controller_disallowed PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_with_mode_controller_allow_all PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_layer_priority_mode_first PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_layer_priority_session_second PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_layer_priority_registry_third PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_with_context_none PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_empty_tool_name PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorCheckAccess::test_check_access_case_sensitive PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIsToolEnabled::test_is_tool_enabled_allowed PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIsToolEnabled::test_is_tool_enabled_disallowed_by_mode PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIsToolEnabled::test_is_tool_enabled_with_context PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetEnabledTools::test_get_enabled_tools_all_available PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetEnabledTools::test_get_enabled_tools_session_restricted PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetEnabledTools::test_get_enabled_tools_mode_allow_all PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetEnabledTools::test_get_enabled_tools_empty_registry PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetEnabledTools::test_get_enabled_tools_with_context PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetAvailableTools::test_get_available_tools_returns_set PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetAvailableTools::test_get_available_tools_empty_registry PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetAvailableTools::test_get_available_tools_delegates_to_registry PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorGetAvailableTools::test_get_available_tools_returns_copy PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetEnabledTools::test_set_enabled_tools_updates_session_tools PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetEnabledTools::test_set_enabled_tools_empty_set PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetEnabledTools::test_set_enabled_tools_propagates_to_tool_selector PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetEnabledTools::test_set_enabled_tools_no_tool_selector PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetEnabledTools::test_set_enabled_tools_overwrites_previous PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetEnabledTools::test_set_enabled_tools_with_duplicate_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorClearSessionRestrictions::test_clear_session_restrictions_resets_to_none PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorClearSessionRestrictions::test_clear_session_restrictions_when_already_none PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorClearSessionRestrictions::test_clear_session_restrictions_after_multiple_sets PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetModeController::test_set_mode_controller_updates_controller PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetModeController::test_set_mode_controller_overwrites_previous PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorSetModeController::test_set_mode_controller_to_none PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorBuildContext::test_build_context_without_mode_controller PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorBuildContext::test_build_context_with_mode_controller PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorBuildContext::test_build_context_with_session_tools PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorBuildContext::test_build_context_missing_mode_attributes PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorFactory::test_factory_with_defaults PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorFactory::test_factory_with_default_allow_all_false PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorFactory::test_factory_with_mode_controller PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorFactory::test_factory_creates_configured_coordinator PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestAccessDecisionDataclass::test_access_decision_creation PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestAccessDecisionDataclass::test_access_decision_defaults PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestAccessDecisionDataclass::test_access_decision_immutability PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessContextDataclass::test_context_creation_with_all_fields PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessContextDataclass::test_context_defaults PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessContextDataclass::test_context_empty_disallowed_tools PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessConfigDataclass::test_config_defaults PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessConfigDataclass::test_config_custom_values PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessConfigDataclass::test_config_to_dict PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessConfigDataclass::test_config_validate PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_build_mode_allows_all_tools PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_plan_mode_restricts_dangerous_tools PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_session_restrictions_override_mode PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_mode_switching_changes_access PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_access_decision_reasons_provided PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_multiple_coordinators_independent_state PASSED [  4%]
tests/unit/agent/coordinators/test_tool_access_coordinator.py::TestToolAccessCoordinatorIntegration::test_clear_restrictions_restores_mode_behavior PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_canonical_name_direct PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_with_result_for_canonical_name PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_unknown_tool_returns_itself PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_with_result_for_unknown_tool PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_legacy_file_operation_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_legacy_search_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_legacy_web_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_legacy_execution_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_legacy_git_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_with_result_for_legacy_name PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_all_legacy_mappings_are_valid PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_is_shell_alias_for_shell_variants PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_is_shell_alias_for_non_shell_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_is_legacy_name_for_known_legacy PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_is_legacy_name_for_canonical_names PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_shell_alias_to_full_shell_when_enabled PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_shell_with_result_for_full_shell PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_shell_to_readonly_when_full_disabled PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_shell_with_result_for_readonly PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_shell_when_both_disabled PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_shell_readonly_directly PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_uses_registry_for_shell_check PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_checks_readonly_when_full_disabled PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolve_with_registry_disabled PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_set_access_check_updates_resolver PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_set_prefer_readonly_updates_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_set_prefer_readonly_false PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_config_prefer_readonly_initialization PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_add_legacy_mapping PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_add_legacy_mapping_updates_class PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_add_legacy_mapping_with_existing_key PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_create_tool_alias_resolver_default PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_create_tool_alias_resolver_with_prefer_readonly PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_create_tool_alias_resolver_with_access_check PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_create_tool_alias_resolver_with_registry PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_create_tool_alias_resolver_with_all_parameters PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_get_canonical_name_for_known_tool PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_get_canonical_name_fallback_on_exception PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_complete_resolution_flow_legacy_then_shell PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolution_with_result_contains_all_fields PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_multiple_resolvers_independent_state PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolver::test_resolver_with_custom_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_resolve_empty_string PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_resolve_with_special_characters PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_resolve_case_sensitivity PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_resolve_unicode_tool_name PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_is_shell_alias_empty_string PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_is_legacy_name_empty_string PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_add_legacy_mapping_empty_strings PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_resolve_with_none_access_check PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_resolve_with_none_registry PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_set_access_check_to_none PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasResolverEdgeCases::test_factory_function_with_none_parameters PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestResolutionResult::test_resolution_result_creation PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestResolutionResult::test_resolution_result_default_is_legacy PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestResolutionResult::test_resolution_result_immutability_attempt PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasConfig::test_config_default_values PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasConfig::test_config_custom_values PASSED [  4%]
tests/unit/agent/coordinators/test_tool_alias_resolver.py::TestToolAliasConfig::test_config_inherits_base_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConfig::test_default_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConfig::test_custom_config PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_initial_budget PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_tool_calls_used_tracking PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_budget_property PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_budget_with_multiplier PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_budget_enforcement PASSED [  4%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_budget_reset PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_budget_status PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_budget_status_after_calls PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_set_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_max_budget_enforcement PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinator::test_disable_budget_tracking PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestBudgetStatus::test_budget_status_creation PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestBudgetStatus::test_budget_status_exhausted PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestBudgetManagerIntegration::test_coordinator_delegates_to_budget_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestBudgetManagerIntegration::test_coordinator_fallback_without_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorBudgetSetter::test_budget_setter_without_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorBudgetSetter::test_budget_setter_with_negative_value PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorBudgetSetter::test_budget_setter_with_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorBudgetUsed::test_budget_used_without_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorBudgetUsed::test_budget_used_with_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorMultiplier::test_budget_multiplier_property PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorMultiplier::test_set_multiplier_updates_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorMultiplier::test_set_multiplier_tracks_history PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorMultiplier::test_set_multiplier_with_fraction PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorMultiplier::test_set_multiplier_with_large_value PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorGetRemaining::test_get_remaining_budget_without_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorGetRemaining::test_get_remaining_budget_with_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorGetRemaining::test_get_remaining_budget_when_exhausted PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorGetRemaining::test_get_remaining_budget_clamps_to_zero PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_with_custom_amount PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_with_zero_amount PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_with_negative_amount PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_tracks_total_consumed_in_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_with_warning_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_multiple_warnings PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_warning_without_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorConsume::test_consume_with_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorReset::test_reset_without_new_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorReset::test_reset_with_new_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorReset::test_reset_with_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorReset::test_reset_increments_reset_count PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorStats::test_get_stats_returns_current_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorStats::test_get_stats_includes_current_budget_used PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorStats::test_clear_stats_resets_all_statistics PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorStats::test_clear_stats_does_not_affect_budget_state PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorStats::test_warning_count_increments PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorFactory::test_factory_with_default_params PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorFactory::test_factory_with_custom_params PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorFactory::test_factory_with_budget_manager PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorIntegration::test_full_budget_lifecycle PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorIntegration::test_budget_exhaustion_detection PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorIntegration::test_utilization_calculation PASSED [  5%]
tests/unit/agent/coordinators/test_tool_budget_coordinator.py::TestToolBudgetCoordinatorIntegration::test_utilization_with_zero_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_initialization PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_initialization_with_console PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_check_tool_calling_capability_supported PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_check_tool_calling_capability_not_supported PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_check_tool_calling_capability_no_provider PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_check_tool_calling_capability_empty_provider PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_log_capability_warning_first_time PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_log_capability_warning_subsequent_times PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_log_capability_warning_warn_once_disabled PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_supported_models PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_supported_models_with_exception PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_capability_info_full PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_capability_info_minimal PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_capability_info_with_exception PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_should_use_tools PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_validate_capability_tool_calling_supported PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_validate_capability_tool_calling_not_supported PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_validate_capability_unknown_capability PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_validate_capability_no_provider PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_capable_models_for_tool_calling PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestToolCapabilityCoordinator::test_get_capable_models_for_other_capability PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestCreateToolCapabilityCoordinator::test_factory_with_defaults PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestCreateToolCapabilityCoordinator::test_factory_with_console PASSED [  5%]
tests/unit/agent/coordinators/test_tool_capability_coordinator.py::TestCreateToolCapabilityCoordinator::test_factory_with_warn_once_false PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorInit::test_initialization_with_defaults PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorInit::test_initialization_with_custom_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorInit::test_initialization_creates_specialized_coordinators PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorInit::test_initialization_with_optional_dependencies PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorInit::test_initialization_with_callbacks PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_budget_property_delegates_to_budget_coordinator PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_budget_setter_delegates_to_budget_coordinator PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_budget_used_property PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_get_remaining_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_consume_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_consume_budget_default_amount PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_reset_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_reset_budget_with_custom_value PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_set_budget_multiplier PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_is_budget_exhausted PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorBudgetManagement::test_execution_count_property PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolAccess::test_get_enabled_tools PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolAccess::test_set_enabled_tools PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolAccess::test_is_tool_enabled PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolAccess::test_get_available_tools PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolAccess::test_set_enabled_tools_propagates_to_selector PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorAliasResolution::test_resolve_tool_alias PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorAliasResolution::test_resolve_shell_alias PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_select_tools_delegates_to_selector PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_select_tools_with_max_tools_override PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_select_tools_without_selector PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_select_tools_calls_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_get_selection_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_get_selection_stats_empty PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorToolSelection::test_clear_selection_history PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_calls_delegates_to_pipeline PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_calls_consumes_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_calls_with_context PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_with_retry_success PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_with_retry_cache_hit PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_with_retry_failure PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_with_retry_attempts PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorExecution::test_execute_tool_with_retry_exception PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_empty_list PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_invalid_structure PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_missing_name PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_disabled_tool PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_budget_exhausted PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_string_arguments PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorHandleToolCalls::test_handle_tool_calls_with_formatter PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorParsing::test_parse_tool_calls_without_adapter PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorParsing::test_normalize_tool_arguments_without_normalizer PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorStatistics::test_get_execution_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorStatistics::test_get_tool_usage_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorStatistics::test_clear_failed_signatures PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorDependencyInjection::test_set_mode_controller PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorDependencyInjection::test_set_tool_planner PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorDependencyInjection::test_set_orchestrator_reference PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorFactory::test_create_tool_coordinator PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorEdgeCases::test_build_tool_access_context_without_mode_controller PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorEdgeCases::test_build_tool_access_context_with_mode_controller PASSED [  5%]
tests/unit/agent/coordinators/test_tool_coordinator.py::TestToolCoordinatorEdgeCases::test_select_tools_exception_handling PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionConfig::test_default_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionConfig::test_custom_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolCallResult::test_successful_result PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolCallResult::test_failed_result PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolCallResult::test_cached_result PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolCallResult::test_skipped_result PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_default_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_custom_initial_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_get_success_rate_empty PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_get_success_rate_all_success PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_get_success_rate_mixed PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_get_avg_execution_time_empty PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionStats::test_get_avg_execution_time PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestExecutionContext::test_default_context PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestExecutionContext::test_context_with_values PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolAccessDecision::test_allowed_decision PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolAccessDecision::test_denied_decision_with_reason PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorInit::test_init_minimal PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorInit::test_init_with_cache PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorInit::test_init_with_sanitizer_and_formatter PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorInit::test_init_with_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorInit::test_init_with_callbacks PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorInit::test_init_with_tool_access_checker PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_empty_tool_calls PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_single_tool_call_success PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_multiple_tool_calls PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_tool_calls_with_context PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_tool_calls_budget_exhausted PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_tool_calls_invalid_structure PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorHandleToolCalls::test_handle_tool_calls_missing_name PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorValidation::test_validate_invalid_tool_name PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorValidation::test_validate_tool_access_denied PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorValidation::test_validate_tool_not_enabled PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorRetryLogic::test_retry_on_transient_error PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorRetryLogic::test_no_retry_on_permanent_error PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorRetryLogic::test_retry_exhausted PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorRetryLogic::test_retry_disabled PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCache::test_cache_hit PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCache::test_cache_miss PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCache::test_cache_invalidation_on_write_file PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCache::test_cache_invalidation_on_execute_bash PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_stats_track_successful_calls PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_stats_track_failed_calls PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_stats_track_budget_consumption PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_stats_track_execution_times PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_stats_track_failed_signatures PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_reset_stats PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_reset_stats_with_custom_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_clear_failed_signatures PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_consume_budget PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorStatistics::test_consume_budget_triggers_warning_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCallbacks::test_on_tool_start_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCallbacks::test_on_tool_complete_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorCallbacks::test_on_budget_warning_callback PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorArgumentNormalization::test_normalize_json_string_arguments PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorArgumentNormalization::test_normalize_dict_arguments PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorArgumentNormalization::test_normalize_none_arguments PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorArgumentNormalization::test_adapter_normalization_applied PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorResultFormatting::test_format_tool_output_default PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorResultFormatting::test_format_tool_output_custom_formatter PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorFailedSignatureTracking::test_skip_repeated_failing_call PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorFailedSignatureTracking::test_different_arguments_not_skipped PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorFailedSignatureTracking::test_successful_call_clears_signature PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorFactory::test_create_tool_execution_coordinator PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorFactory::test_create_tool_execution_coordinator_with_cache PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorEdgeCases::test_handle_exception_during_execution PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorEdgeCases::test_mixed_success_and_failure PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorEdgeCases::test_concurrent_execution PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorEdgeCases::test_get_execution_stats_returns_copy PASSED [  5%]
tests/unit/agent/coordinators/test_tool_execution_coordinator.py::TestToolExecutionCoordinatorEdgeCases::test_tool_name_resolution PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_initialization PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_initialization_with_all_components PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_successful_tool_execution PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_with_cache_hit PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_retry_on_failure PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_non_retryable_error PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_max_attempts_reached PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_timeout_error PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_connection_error PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_tool_execution_with_task_completion PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_cache_invalidation_on_write PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_cache_namespace_clear_on_bash PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_calculate_backoff PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_get_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestToolRetryCoordinator::test_update_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestCreateToolRetryCoordinator::test_factory_with_defaults PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestCreateToolRetryCoordinator::test_factory_with_custom_config PASSED [  5%]
tests/unit/agent/coordinators/test_tool_retry_coordinator.py::TestCreateToolRetryCoordinator::test_factory_with_all_components PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorInit::test_init_with_tool_registry PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorInit::test_init_stores_registry_reference PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorInit::test_keyword_sets_are_defined PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorInit::test_tool_patterns_are_defined PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_empty_query_returns_none PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_whitespace_query_returns_none PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_none_query_returns_none PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_semantic_search_indicators PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_file_pattern_indicators PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_web_search_indicators PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_code_search_defaults_to_grep PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_generic_query_returns_none PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_case_insensitive_matching PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_with_context_parameter PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestGetRecommendedSearchTool::test_multiple_indicators_priority PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_routes_to_recommended_tool_if_available PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_falls_back_to_grep_if_recommended_unavailable PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_falls_back_to_ls_if_grep_unavailable PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_returns_first_available_tool_as_last_resort PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_returns_grep_as_default_when_no_tools_available PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_with_multiple_available_tools PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestRouteSearchQuery::test_with_custom_tool_names PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_empty_prompt_returns_empty_set PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_none_prompt_returns_empty_set PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_grep_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_ls_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_read_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_write_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_web_search_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_semantic_search_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_code_search_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_bash_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_detect_shell_mention PASSED [  5%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_multiple_tools_in_one_prompt PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_case_insensitive_detection PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_filters_by_available_tools PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_no_filtering_when_available_tools_none PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_word_boundary_matching PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestDetectMentionedTools::test_partial_tool_names PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_empty_task_returns_analysis PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_none_task_returns_analysis PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_analysis_keywords_detected PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_action_keywords_detected PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_creation_keywords_detected PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_creation_takes_priority_over_action PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_action_takes_priority_over_analysis PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_case_insensitive_classification PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_multiple_keywords_same_category PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_mixed_keywords_selects_dominant PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskKeywords::test_conversation_history_parameter_accepted PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_without_context_delegates_to_keyword_classification PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_with_executing_stage_and_action_keywords PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_with_recent_write_tools PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_with_recent_non_write_tools PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_analysis_task_not_affected_by_recent_tools PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_stage_name_case_insensitive PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestClassifyTaskWithContext::test_context_with_all_fields PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_empty_message_returns_false PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_whitespace_message_returns_false PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_explicit_tool_mention_returns_true PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_tool_keywords_return_true PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_question_without_tool_keywords_returns_false PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_question_with_tool_keywords_returns_true PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_case_insensitive_keyword_matching PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_model_supports_tools_parameter PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_generic_message_without_keywords_returns_false PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_message_with_multiple_keywords PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestShouldUseTools::test_imperative_commands PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_empty_prompt_returns_empty_set PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_none_prompt_returns_empty_set PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_extract_unix_file_paths PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_extract_windows_file_paths PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_extract_relative_paths PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_extract_files_with_extensions PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_filters_long_paths PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_requires_path_separator_or_extension PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_quoted_file_paths PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_multiple_files_in_prompt PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredFiles::test_files_with_directories PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_empty_prompt_returns_empty_set PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_none_prompt_returns_empty_set PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_save_to_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_write_to_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_output_to_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_store_in_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_export_as_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_create_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_generate_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_extract_produce_pattern PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_case_insensitive_matching PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_multiple_outputs_in_prompt PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_quoted_outputs PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestExtractRequiredOutputs::test_output_with_path PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorIntegration::test_complete_tool_selection_workflow PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorIntegration::test_context_aware_selection PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorIntegration::test_search_and_extraction_workflow PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_unicode_in_queries PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_special_characters_in_file_paths PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_very_long_query PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_mixed_tool_mentions PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_nested_keywords PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_ambiguous_queries PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_empty_available_tools_set PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_single_available_tool PASSED [  6%]
tests/unit/agent/coordinators/test_tool_selection_coordinator.py::TestToolSelectionCoordinatorEdgeCases::test_mixed_case_stage_names PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationResult::test_validation_result_initialization PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationResult::test_validation_result_with_errors PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationResult::test_add_error_updates_validity PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationResult::test_add_warning_preserves_validity PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationResult::test_add_multiple_errors PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationResult::test_add_multiple_warnings PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_initialization_with_defaults PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_meets_quality_threshold_default PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_meets_quality_threshold_custom PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_meets_quality_threshold_exact PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_meets_grounding_threshold_default PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_meets_grounding_threshold_custom PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_meets_grounding_threshold_exact PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestIntelligentValidationResult::test_all_fields_populated PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestToolCallValidationResult::test_initialization_with_defaults PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestToolCallValidationResult::test_initialization_with_values PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestContextValidationResult::test_initialization_with_defaults PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestContextValidationResult::test_initialization_with_values PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorConfig::test_default_configuration PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorConfig::test_custom_configuration PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_config_property PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_config_property_custom PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_intelligent_integration_property PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_context_manager_property PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_response_coordinator_property PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_success PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_below_threshold PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_short_response PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_empty_response PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_whitespace_only PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_disabled_integration PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_disabled_in_config PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_integration_returns_none PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_exception_handled PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_partial_data PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_intelligent_response_custom_min_length PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_call_structure_valid_dict PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_call_structure_missing_name PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_call_structure_not_dict PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_call_structure_list PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_call_structure_none PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_name_valid PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_name_empty PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_name_with_coordinator PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_name_without_coordinator PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_tool_name_invalid_characters PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_none PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_empty_list PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_valid PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_filters_invalid_structure PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_filters_invalid_names PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_with_response_coordinator PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_response_coordinator_exception PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_and_filter_tool_calls_disabled_in_config PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_check_context_overflow_no_manager PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_check_context_overflow_disabled_in_config PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_check_context_overflow_no_overflow PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_check_context_overflow_with_overflow PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_check_context_overflow_zero_max PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_check_context_overflow_exception PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_get_max_context_chars_with_manager PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_get_max_context_chars_without_manager PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_get_max_context_chars_exception PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_is_cancelled_with_metrics_coordinator PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_is_cancelled_with_metrics_coordinator_is_cancelled_method PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_is_cancelled_with_cancel_event PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_is_cancelled_metrics_coordinator_exception PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_is_cancelled_cancel_event_exception PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_is_cancelled_no_cancel_mechanisms PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_query_valid PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_query_empty PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_query_none PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_query_not_string PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_query_long_warning PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_task_type_valid PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_task_type_empty PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_task_type_unknown PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_task_type_case_insensitive PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_task_type_all_known_types PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_request_all_valid PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_request_invalid_query PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_request_with_warnings PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_request_context_overflow PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_request_cancelled PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_validate_request_multiple_issues PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_coordinator_initialization_logging PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinator::test_coordinator_with_all_dependencies PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_validate_tool_name_with_unicode PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_validate_query_with_unicode PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_validate_tool_call_with_nested_dict PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_validate_and_filter_tool_calls_all_filtered PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_validation_result_metadata_operations PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_intelligent_validation_result_threshold_methods PASSED [  6%]
tests/unit/agent/coordinators/test_validation_coordinator.py::TestValidationCoordinatorEdgeCases::test_context_validation_result_utilization_calculation PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_initialization_with_workflow_registry PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_workflow_registry_property PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_register_default_workflows_calls_discovery PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_register_default_workflows_returns_count PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_register_default_workflows_with_zero_workflows PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_register_default_workflows_with_discovery_error PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_register_default_workflows_with_real_registry PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_list_workflows_returns_empty_list_when_no_workflows PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_list_workflows_returns_workflow_names PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_list_workflows_with_single_workflow PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_list_workflows_with_many_workflows PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_list_workflows_returns_new_list_each_time PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_has_workflow_returns_true_when_workflow_exists PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_has_workflow_returns_false_when_workflow_not_exists PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_has_workflow_with_empty_registry PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_has_workflow_with_multiple_workflows PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_has_workflow_case_sensitive PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_get_workflow_count_returns_zero_when_empty PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_get_workflow_count_returns_correct_count PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_get_workflow_count_with_single_workflow PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_get_workflow_count_with_many_workflows PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinator::test_get_workflow_count_changes_after_registration PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorIntegration::test_full_workflow_registration_lifecycle PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorIntegration::test_multiple_workflow_registration_and_listing PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorIntegration::test_workflow_operations_with_real_registry PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_workflow_registry_with_special_characters_in_names PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_workflow_names_with_unicode PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_list_workflows_returns_copy_not_reference PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_register_default_workflows_multiple_calls PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_has_workflow_with_empty_string PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_list_workflows_with_empty_registry_keys PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_register_default_workflows_with_exception_during_registration PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorEdgeCases::test_workflow_coordinator_with_mocked_registry_property_access PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorWithRealWorkflows::test_coordinator_with_real_workflow_registration PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorWithRealWorkflows::test_coordinator_workflow_access_via_registry PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorWithRealWorkflows::test_duplicate_workflow_registration_prevented PASSED [  6%]
tests/unit/agent/coordinators/test_workflow_coordinator.py::TestWorkflowCoordinatorWithRealWorkflows::test_coordinator_after_workflow_removal_simulation PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestTaskOutcome::test_create_outcome_success PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestTaskOutcome::test_create_outcome_failure PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestTaskOutcome::test_outcome_to_dict PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestTaskOutcome::test_outcome_from_dict PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestProficiencyTracker::test_initialization PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestProficiencyTracker::test_initialization_custom_window PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestProficiencyTracker::test_ensure_tables PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_success PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_failure PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_with_quality_score PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_with_duration PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_with_cost PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_multiple_outcomes_batch PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_updates_proficiency PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_updates_task_success_rate PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_invalidates_cache PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestRecordOutcome::test_record_outcome_with_errors PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_proficiency_new_tool PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_proficiency_existing_tool PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_proficiency_caching PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_proficiency_invalidation PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_top_proficiencies PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_weaknesses_below_threshold PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_weaknesses_empty PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_weaknesses_high_threshold PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_task_success_rate_new_task PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetProficiency::test_get_task_success_rate_existing_task PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_update_proficiency_incremental PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_update_proficiency_clamps_to_zero PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_update_proficiency_clamps_to_one PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_detect_trend_improving PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_detect_trend_declining PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_detect_trend_stable PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_detect_trend_insufficient_data PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_get_improvement_trajectory PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_export_training_data PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestImprovementTracking::test_export_training_data_empty PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestMovingAverageMetrics::test_get_moving_average_metrics PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestMovingAverageMetrics::test_get_moving_average_metrics_insufficient_data PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestMovingAverageMetrics::test_compute_moving_average PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestMovingAverageMetrics::test_compute_moving_average_insufficient_data PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestStatisticsAndExport::test_get_statistics_summary PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestStatisticsAndExport::test_analyze_performance_patterns PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestTrendDirection::test_trend_direction_values PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestProficiencyScore::test_proficiency_score_to_dict PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestSuggestion::test_suggestion_to_dict PASSED [  6%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestProficiencyMetrics::test_proficiency_metrics_to_dict PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestUtilityMethods::test_get_all_tools PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestUtilityMethods::test_get_all_tasks PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestUtilityMethods::test_reset_tool PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestUtilityMethods::test_reset_all PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestExportMetrics::test_export_metrics_empty PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestExportMetrics::test_export_metrics_with_data PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestExportMetrics::test_export_metrics_top_performing_tools PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestExportMetrics::test_export_metrics_improvement_opportunities PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestSuggestToolForTask::test_suggest_tool_for_task_no_data PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestSuggestToolForTask::test_suggest_tool_for_task_with_data PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestSuggestToolForTask::test_suggest_tool_for_task_minimum_executions PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetImprovementSuggestions::test_get_improvement_suggestions_no_data PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetImprovementSuggestions::test_get_improvement_suggestions_low_success_rate PASSED [  7%]
tests/unit/agent/improvement/test_proficiency_tracker.py::TestGetImprovementSuggestions::test_get_improvement_suggestions_declining_trend PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisode::test_episode_creation_with_defaults PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisode::test_episode_creation_with_values PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisode::test_episode_to_text_conversion PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisode::test_episode_to_text_empty_fields PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisode::test_episode_compute_effective_importance PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisode::test_episode_repr PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisodeMemory::test_episode_memory_creation PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisodeMemory::test_episode_memory_with_custom_metadata PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisodeMemory::test_episode_memory_update_access FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestEpisodeMemory::test_episode_memory_to_dict FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryStats::test_memory_stats_creation FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryStats::test_memory_stats_default_values FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_memory_index_creation FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_add_embedding FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_remove_embedding FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_get_embedding PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_get_embedding_not_found PASSED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_index_metadata FAILED [  7%]
tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_index_actions FAILED [  7%]

=================================== FAILURES ===================================
______________ TestChatCoordinatorChat.test_chat_simple_response _______________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14119933408'>
        key        = 'prompt_tokens'
        orch       = <Mock id='6380775968'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='6380775968'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='6380775968'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='6380775968'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='14119931584'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14119934368'>
        total_tokens = 0
        user_message = 'Hello'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:271: in test_chat_simple_response
    response = await coordinator.chat("Hello")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        mock_orchestrator = <Mock id='6380775968'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x1149982f0>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='6380775968'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        tool_calls_list = []
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14119933408'>
        key        = 'prompt_tokens'
        orch       = <Mock id='6380775968'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x112dc39e0>
        user_message = 'Hello'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_________ TestChatCoordinatorChat.test_chat_with_token_usage_tracking __________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='6382959360'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119930144'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14119930144'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14119930144'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14119930144'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='6383188544'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='6383187680'>
        total_tokens = 0
        user_message = 'Hello'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:298: in test_chat_with_token_usage_tracking
    await coordinator.chat("Hello")
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        mock_orchestrator = <Mock id='14119930144'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x114998830>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14119930144'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        tool_calls_list = []
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='6382959360'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119930144'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499403b0>
        user_message = 'Hello'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
______________ TestChatCoordinatorChat.test_chat_with_tool_calls _______________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='6352468016'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119320224'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        user_message = 'Use a tool'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14119320224'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        user_message = 'Use a tool'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14119320224'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        user_message = 'Use a tool'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14119320224'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='6422359664'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='6337777728'>
        total_tokens = 0
        user_message = 'Use a tool'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:335: in test_chat_with_tool_calls
    response = await coordinator.chat("Use a tool")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        final_response = CompletionResponse(content='Final response', role='assistant', tool_calls=None, stop_reason=None, usage=None, model=None, raw_response=None, metadata=None)
        mock_orchestrator = <Mock id='14119320224'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x114998cb0>
        tool_call_response = CompletionResponse(content='Thinking...', role='assistant', tool_calls=[{'name': 'test_tool', 'arguments': {}}], stop_reason=None, usage=None, model=None, raw_response=None, metadata=None)
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14119320224'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        tool_calls_list = []
        user_message = 'Use a tool'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='6352468016'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119320224'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x17fade660>
        user_message = 'Use a tool'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_____ TestChatCoordinatorChat.test_chat_with_empty_response_uses_completer _____
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='5221117408'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14084285664'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14084285664'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14084285664'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14084285664'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='5197854528'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='5197855632'>
        total_tokens = 0
        user_message = 'Hello'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:356: in test_chat_with_empty_response_uses_completer
    response = await coordinator.chat("Hello")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        mock_orchestrator = <Mock id='14084285664'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x114999130>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14084285664'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        tool_calls_list = []
        user_message = 'Hello'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='5221117408'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14084285664'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x34815fcb0>
        user_message = 'Hello'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
__________ TestChatCoordinatorChat.test_chat_max_iterations_exceeded ___________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='6383268208'>
        key        = 'prompt_tokens'
        orch       = <Mock id='5221555552'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        user_message = 'Keep working'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='5221555552'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        user_message = 'Keep working'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='5221555552'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        user_message = 'Keep working'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='5221555552'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='6347695616'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14109931136'>
        total_tokens = 0
        user_message = 'Keep working'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:383: in test_chat_max_iterations_exceeded
    response = await coordinator.chat("Keep working")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        mock_orchestrator = <Mock id='5221555552'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x1149995b0>
        tool_response = CompletionResponse(content='Still working', role='assistant', tool_calls=[{'name': 'loop_tool', 'arguments': {}}], stop_reason=None, usage=None, model=None, raw_response=None, metadata=None)
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='5221555552'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        tool_calls_list = []
        user_message = 'Keep working'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='6383268208'>
        key        = 'prompt_tokens'
        orch       = <Mock id='5221555552'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d7cb0>
        user_message = 'Keep working'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
___________ TestChatCoordinatorChat.test_chat_with_thinking_enabled ____________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14119934608'>
        key        = 'prompt_tokens'
        orch       = <Mock id='4610854976'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        user_message = 'Think about this'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='4610854976'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        user_message = 'Think about this'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='4610854976'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        user_message = 'Think about this'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='4610854976'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='14119306160'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14119319216'>
        total_tokens = 0
        user_message = 'Think about this'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:398: in test_chat_with_thinking_enabled
    await coordinator.chat("Think about this")
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        mock_orchestrator = <Mock id='4610854976'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x114999a30>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='4610854976'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        tool_calls_list = []
        user_message = 'Think about this'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14119934608'>
        key        = 'prompt_tokens'
        orch       = <Mock id='4610854976'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x347d1a0c0>
        user_message = 'Think about this'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
__________ TestChatCoordinatorChat.test_chat_with_context_compaction ___________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14123343536'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119935376'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        user_message = 'Long conversation message'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14119935376'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        user_message = 'Long conversation message'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14119935376'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        user_message = 'Long conversation message'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14119935376'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='14119931776'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14119930528'>
        total_tokens = 0
        user_message = 'Long conversation message'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:419: in test_chat_with_context_compaction
    await coordinator.chat("Long conversation message")
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        mock_compactor = <Mock name='mock._context_compactor' id='14123342288'>
        mock_orchestrator = <Mock id='14119935376'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x114999eb0>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14119935376'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        tool_calls_list = []
        user_message = 'Long conversation message'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14123343536'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119935376'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x3499d0170>
        user_message = 'Long conversation message'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
________ TestChatCoordinatorChat.test_chat_tool_failure_uses_completer _________
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14123343632'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14123342096'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14123342096'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14123342096'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14123342096'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='14123343728'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14123345600'>
        total_tokens = 0
        user_message = 'Use failing tool'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:443: in test_chat_tool_failure_uses_completer
    response = await coordinator.chat("Use failing tool")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        mock_orchestrator = <Mock id='14123342096'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorChat object at 0x11499a330>
        tool_response = CompletionResponse(content='', role='assistant', tool_calls=[{'name': 'failing_tool', 'arguments': {}}], stop_reason=None, usage=None, model=None, raw_response=None, metadata=None)
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14123342096'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        tool_calls_list = []
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14123343632'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14123342096'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d118b0>
        user_message = 'Use failing tool'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_____ TestChatCoordinatorEdgeCases.test_chat_completer_fails_uses_fallback _____
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14123368672'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14123373712'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        user_message = 'Test fallback'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14123373712'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        user_message = 'Test fallback'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14123373712'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        user_message = 'Test fallback'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14123373712'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='14123193872'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14123193968'>
        total_tokens = 0
        user_message = 'Test fallback'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:1241: in test_chat_completer_fails_uses_fallback
    response = await coordinator.chat("Test fallback")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        mock_orchestrator = <Mock id='14123373712'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorEdgeCases object at 0x1149ae5d0>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14123373712'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        tool_calls_list = []
        user_message = 'Test fallback'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14123368672'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14123373712'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349d1a540>
        user_message = 'Test fallback'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_ TestChatCoordinatorEdgeCases.test_chat_with_tool_failures_uses_format_message _
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14119418240'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14123203136'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14123203136'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14123203136'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14123203136'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='6326188656'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14123377552'>
        total_tokens = 0
        user_message = 'Use failing tool'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:1272: in test_chat_with_tool_failures_uses_format_message
    response = await coordinator.chat("Use failing tool")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        mock_orchestrator = <Mock id='14123203136'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorEdgeCases object at 0x1149ae930>
        tool_response = CompletionResponse(content='', role='assistant', tool_calls=[{'name': 'failing_tool', 'arguments': {}}], stop_reason=None, usage=None, model=None, raw_response=None, metadata=None)
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14123203136'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        tool_calls_list = []
        user_message = 'Use failing tool'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14119418240'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14123203136'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349cefaa0>
        user_message = 'Use failing tool'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_____ TestChatCoordinatorEdgeCases.test_chat_provider_exception_propagates _____
victor/agent/coordinators/chat_coordinator.py:163: in stream_chat
    async for chunk in self._stream_chat_impl(user_message):
        ctx        = <Mock name='mock._current_stream_context' id='14119308176'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119417424'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        user_message = 'Trigger error'
victor/agent/coordinators/chat_coordinator.py:206: in _stream_chat_impl
    stream_ctx = await self._create_stream_context(user_message)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        orch       = <Mock id='14119417424'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        user_message = 'Trigger error'
victor/agent/coordinators/chat_coordinator.py:824: in _create_stream_context
    ) = await self._prepare_stream(user_message)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        create_stream_context = <function create_stream_context at 0x13501f600>
        orch       = <Mock id='14119417424'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        user_message = 'Trigger error'
victor/agent/coordinators/chat_coordinator.py:718: in _prepare_stream
    await orch._context_manager.start_background_compaction(interval_seconds=15.0)
E   TypeError: object Mock can't be used in 'await' expression
        cumulative_usage = {'cache_creation_input_tokens': 0,
 'cache_read_input_tokens': 0,
 'completion_tokens': 0,
 'prompt_tokens': 0,
 'total_tokens': 0}
        orch       = <Mock id='14119417424'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        start_time = <Mock name='mock._metrics_collector.init_stream_metrics().start_time' id='14119305920'>
        stream_metrics = <Mock name='mock._metrics_collector.init_stream_metrics()' id='14119306640'>
        total_tokens = 0
        user_message = 'Trigger error'

During handling of the above exception, another exception occurred:
tests/unit/agent/coordinators/test_chat_coordinator.py:1288: in test_chat_provider_exception_propagates
    await coordinator.chat("Trigger error")
        coordinator = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        mock_orchestrator = <Mock id='14119417424'>
        self       = <coordinators.test_chat_coordinator.TestChatCoordinatorEdgeCases object at 0x11499a660>
victor/agent/coordinators/chat_coordinator.py:117: in chat
    async for chunk in self.stream_chat(user_message):
        StreamChunk = <class 'victor.providers.base.StreamChunk'>
        full_content = []
        orch       = <Mock id='14119417424'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        tool_calls_list = []
        user_message = 'Trigger error'
victor/agent/coordinators/chat_coordinator.py:172: in stream_chat
    if key in ctx.cumulative_usage:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: argument of type 'Mock' is not iterable
        ctx        = <Mock name='mock._current_stream_context' id='14119308176'>
        key        = 'prompt_tokens'
        orch       = <Mock id='14119417424'>
        self       = <victor.agent.coordinators.chat_coordinator.ChatCoordinator object at 0x349953bc0>
        user_message = 'Trigger error'
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_____________ TestEpisodeMemory.test_episode_memory_update_access ______________
tests/unit/agent/memory/test_episodic_memory.py:228: in test_episode_memory_update_access
    assert episode_memory.episode.access_count == initial_count + 1
E   AssertionError: assert 0 == (0 + 1)
E    +  where 0 = Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0).access_count
E    +    where Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0) = EpisodeMemory(episode=Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0), embedding_id='e7ba926a-f55c-42f2-a933-f830ec197835', created_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 976585), updated_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 976615), access_count=1, last_accessed=datetime.datetime(2026, 1, 21, 2, 16, 6, 976606), metadata={}).episode
        episode_memory = EpisodeMemory(episode=Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0),
              embedding_id='e7ba926a-f55c-42f2-a933-f830ec197835',
              created_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 976585),
              updated_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 976615),
              access_count=1,
              last_accessed=datetime.datetime(2026, 1, 21, 2, 16, 6, 976606),
              metadata={})
        initial_count = 0
        sample_episode = Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0)
        self       = <memory.test_episodic_memory.TestEpisodeMemory object at 0x132adf9b0>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
________________ TestEpisodeMemory.test_episode_memory_to_dict _________________
tests/unit/agent/memory/test_episodic_memory.py:234: in test_episode_memory_to_dict
    data = episode_memory.to_dict()
           ^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'EpisodeMemory' object has no attribute 'to_dict'
        episode_memory = EpisodeMemory(episode=Episode(id=5be1373e..., timestamp=2026-01-21T02:16:06.995233, actions=3, reward=0.0),
              embedding_id='224a38aa-b571-4ddc-8094-e48b8522a7fa',
              created_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 995507),
              updated_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 995517),
              access_count=0,
              last_accessed=None,
              metadata={})
        sample_episode = Episode(id=5be1373e..., timestamp=2026-01-21T02:16:06.995233, actions=3, reward=0.0)
        self       = <memory.test_episodic_memory.TestEpisodeMemory object at 0x132adfbc0>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
__________________ TestMemoryStats.test_memory_stats_creation __________________
tests/unit/agent/memory/test_episodic_memory.py:251: in test_memory_stats_creation
    stats = MemoryStats(
E   TypeError: MemoryStats.__init__() got an unexpected keyword argument 'episode_count'
        self       = <memory.test_episodic_memory.TestMemoryStats object at 0x132a38770>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_______________ TestMemoryStats.test_memory_stats_default_values _______________
tests/unit/agent/memory/test_episodic_memory.py:272: in test_memory_stats_default_values
    stats = MemoryStats(
E   TypeError: MemoryStats.__init__() got an unexpected keyword argument 'episode_count'
        now        = datetime.datetime(2026, 1, 21, 2, 16, 7, 52095)
        self       = <memory.test_episodic_memory.TestMemoryStats object at 0x132a38e90>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
__________________ TestMemoryIndex.test_memory_index_creation __________________
tests/unit/agent/memory/test_episodic_memory.py:300: in test_memory_index_creation
    assert index._embeddings == {}
           ^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryIndex' object has no attribute '_embeddings'. Did you mean: 'embeddings'?
        index      = MemoryIndex(embeddings={},
            metadata_index={'by_key': {}},
            action_index={},
            outcome_index={},
            temporal_index=[],
            dimension=384)
        self       = <memory.test_episodic_memory.TestMemoryIndex object at 0x132a39250>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
______________________ TestMemoryIndex.test_add_embedding ______________________
tests/unit/agent/memory/test_episodic_memory.py:315: in test_add_embedding
    assert episode_id in index._embeddings
                         ^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryIndex' object has no attribute '_embeddings'. Did you mean: 'embeddings'?
        embedding  = array([7.28129089e-01, 3.63207281e-01, 1.28024444e-01, 5.99272132e-01,
       1.27678111e-01, 1.89553469e-01, 8.17742348e-01, 3.69817525e-01,
       7.51753300e-02, 4.37412143e-01, 4.22465295e-01, 6.19491220e-01,
       6.58135474e-01, 4.69297171e-01, 5.09486616e-01, 4.82975841e-01,
       9.25196409e-01, 3.16171706e-01, 3.76886427e-01, 5.95246017e-01,
       4.87031907e-01, 9.98798609e-01, 5.03770769e-01, 4.96487498e-01,
       7.25180328e-01, 5.39901733e-01, 1.14436269e-01, 2.99044400e-01,
       9.21357512e-01, 5.64083993e-01, 3.41100067e-01, 3.32555801e-01,
       9.24055457e-01, 5.99725604e-01, 8.38051796e-01, 1.09694958e-01,
       5.63494146e-01, 1.20461337e-01, 4.21167433e-01, 9.61774588e-01,
       3.33909273e-01, 2.66393334e-01, 1.91199958e-01, 6.58743903e-02,
       3.29939905e-03, 2.29421392e-01, 4.58112538e-01, 4.72393006e-01,
       7.82953084e-01, 8.59366536e-01, 7.73691595e-01, 9.17094171e-01,
       1.34494200e-01, 9.85464394e-01, 2.90628493e-01, 8.15362036e-01,
       1.42962843e-01, 9.35251176e-01, 1.84095860e-01, 9.17438805e-01,
       8.48845661e-01, 1.49283946e-01, 6.43527567e-01, 4.91439909e-01,
       2.04187978e-04, 9.74248528e-01, 3.52177769e-02, 7.01530457e-01,
       2.29267493e-01, 3.73786986e-02, 9.57324564e-01, 2.33622506e-01,
       9.60032821e-01, 5.05452394e-01, 2.48971850e-01, 8.09755564e-01,
       4.07148972e-02, 5.91799282e-02, 3.64355206e-01, 1.71176121e-01,
       2.44690403e-01, 9.80700076e-01, 9.20932353e-01, 1.99488685e-01,
       7.34189749e-01, 1.28495649e-01, 1.29677560e-02, 3.02048445e-01,
       8.52683485e-01, 6.13745868e-01, 2.64557879e-02, 7.33073652e-01,
       9.28478301e-01, 4.47242051e-01, 9.46873963e-01, 6.17265105e-01,
       8.77478659e-01, 6.22962058e-01, 4.16158438e-01, 8.70441258e-01,
       1.28760770e-01, 6.65884078e-01, 3.09782743e-01, 3.74453276e-01,
       3.20772558e-01, 7.29788303e-01, 3.14494818e-01, 5.52449048e-01,
       2.80317217e-01, 2.80287325e-01, 4.49607432e-01, 3.21216255e-01,
       6.39839351e-01, 2.22188354e-01, 1.76943645e-01, 7.92106763e-02,
       2.71614939e-01, 3.62022161e-01, 5.19991040e-01, 5.17397702e-01,
       7.98965991e-01, 4.81150568e-01, 8.38890791e-01, 4.04397070e-01,
       3.62679213e-01, 7.27004945e-01, 4.67327237e-01, 7.39854351e-02,
       4.54124421e-01, 7.05168903e-01, 3.31499219e-01, 3.20511349e-02,
       8.48214090e-01, 4.68561739e-01, 4.66063648e-01, 7.31443644e-01,
       6.83556855e-01, 2.52349377e-01, 6.25465691e-01, 3.59815478e-01,
       5.86886525e-01, 5.26492894e-01, 2.73389161e-01, 6.61264479e-01,
       2.10690811e-01, 6.84140921e-01, 3.49763274e-01, 2.70160675e-01,
       6.43265188e-01, 8.38871896e-01, 4.92087096e-01, 1.76572263e-01,
       4.16473389e-01, 6.16283119e-01, 9.40418243e-01, 8.43072474e-01,
       7.75265872e-01, 7.67990291e-01, 6.00105166e-01, 3.78884465e-01,
       7.94472873e-01, 2.17910558e-01, 3.38915646e-01, 4.52309757e-01,
       4.91272628e-01, 7.81403244e-01, 4.53415126e-01, 4.15363222e-01,
       5.57945311e-01, 6.91688061e-01, 9.27446596e-03, 7.76369333e-01,
       8.52208674e-01, 3.16760361e-01, 5.40991127e-01, 6.70610011e-01,
       4.13098037e-01, 4.72259343e-01, 6.84576333e-02, 5.24280630e-02,
       2.18689904e-01, 4.95429516e-01, 4.63609070e-01, 4.19498295e-01,
       6.09843016e-01, 2.18339264e-01, 7.93177247e-01, 2.06750408e-01,
       4.43439990e-01, 5.31324968e-02, 7.07634032e-01, 1.67062253e-01,
       4.27430123e-02, 5.21094501e-01, 6.32939935e-01, 6.50189042e-01,
       4.33291674e-01, 6.30978465e-01, 6.94349706e-02, 1.84334621e-01,
       9.47676748e-02, 4.16002907e-02, 6.64120018e-01, 2.97599643e-01,
       9.06884223e-02, 3.31310064e-01, 4.21620578e-01, 6.83054179e-02,
       2.34887347e-01, 3.79241645e-01, 3.35537046e-01, 4.95025843e-01,
       1.00468220e-02, 2.28745311e-01, 6.69329405e-01, 7.29600787e-02,
       6.41683519e-01, 5.11392474e-01, 5.63332498e-01, 9.10971701e-01,
       1.58158429e-02, 1.38357148e-01, 6.82387799e-02, 7.55052388e-01,
       9.82282579e-01, 2.11690944e-02, 4.04511653e-02, 9.83132780e-01,
       8.70744467e-01, 7.65970722e-02, 1.06137633e-01, 6.37952834e-02,
       1.35804757e-01, 4.95464891e-01, 3.99038315e-01, 7.74711013e-01,
       8.77556980e-01, 7.31494844e-01, 8.49262357e-01, 1.80715412e-01,
       8.58075082e-01, 4.13116932e-01, 4.97205138e-01, 7.47738481e-01,
       3.18718374e-01, 5.12518883e-02, 9.66328681e-01, 6.85462296e-01,
       2.77051866e-01, 5.61538458e-01, 3.77648711e-01, 1.88045740e-01,
       6.71490431e-01, 8.46407890e-01, 1.64235815e-01, 6.87834322e-01,
       9.07136947e-02, 3.94660085e-01, 3.05658937e-01, 1.96535200e-01,
       2.54615247e-02, 5.31568766e-01, 9.88965511e-01, 8.99110436e-01,
       3.72278720e-01, 3.88998955e-01, 6.17105246e-01, 5.99022388e-01,
       8.73665392e-01, 3.61524910e-01, 3.64950925e-01, 4.73734498e-01,
       4.11509216e-01, 7.73669958e-01, 9.80675295e-02, 8.19212377e-01,
       3.19029987e-01, 3.96242678e-01, 1.38434231e-01, 4.52358842e-01,
       8.36389720e-01, 3.10222775e-01, 3.83639753e-01, 3.37498754e-01,
       8.36540222e-01, 8.97871912e-01, 1.50486141e-01, 1.08453475e-01,
       2.93728769e-01, 2.56447911e-01, 7.39043415e-01, 1.13210179e-01,
       4.46316302e-01, 6.35473609e-01, 5.58257282e-01, 7.52290010e-01,
       2.41069913e-01, 4.97457743e-01, 9.49434817e-01, 4.40553814e-01,
       6.28195584e-01, 5.94184518e-01, 6.10438943e-01, 5.38967609e-01,
       9.59037483e-01, 8.79278481e-01, 1.37715042e-01, 1.44743562e-01,
       6.09349728e-01, 7.58314788e-01, 4.62189764e-01, 2.29672983e-01,
       9.79865074e-01, 9.60876226e-01, 6.54523969e-02, 2.83805430e-01,
       4.51579034e-01, 6.67674482e-01, 4.54834849e-01, 4.65486944e-01,
       9.61396158e-01, 5.17292738e-01, 4.01838183e-01, 5.18756688e-01,
       1.42737478e-01, 2.19862521e-01, 3.34246814e-01, 7.18258858e-01,
       3.17296743e-01, 4.99515653e-01, 2.52541423e-01, 5.72858691e-01,
       3.38269174e-01, 5.30649006e-01, 6.49369461e-03, 6.80236638e-01,
       4.85730320e-01, 8.97724330e-01, 8.28289568e-01, 6.86036825e-01,
       6.37103617e-01, 6.59882486e-01, 5.99916816e-01, 8.86413693e-01,
       5.61470628e-01, 8.46448958e-01, 3.59398603e-01, 5.83821177e-01,
       8.85347068e-01, 8.31316948e-01, 8.80407467e-02, 3.65901381e-01,
       7.51738310e-01, 7.97282577e-01, 6.37924194e-01, 2.43133567e-02,
       6.57234907e-01, 7.37769306e-01, 2.34730527e-01, 3.93983036e-01,
       2.01524928e-01, 5.22921264e-01, 5.93141198e-01, 8.32951725e-01,
       7.01063395e-01, 6.60746217e-01, 1.41838923e-01, 1.20144978e-01,
       5.40323965e-02, 2.19392627e-01, 3.41572732e-01, 4.58034933e-01,
       6.35955572e-01, 8.57032061e-01, 8.40842962e-01, 4.24393445e-01,
       6.81003451e-01, 8.09939206e-01, 9.98931974e-02, 8.13999593e-01,
       4.92103785e-01, 3.49567950e-01, 5.57509840e-01, 3.64384204e-01],
      dtype=float32)
        episode_id = 'test_id'
        index      = MemoryIndex(embeddings={'test_id': array([7.28129089e-01, 3.63207281e-01, 1.28024444e-01, 5.99272132e-01,
       1.27678111e-01, 1.89553469e-01, 8.17742348e-01, 3.69817525e-01,
       7.51753300e-02, 4.37412143e-01, 4.22465295e-01, 6.19491220e-01,
       6.58135474e-01, 4.69297171e-01, 5.09486616e-01, 4.82975841e-01,
       9.25196409e-01, 3.16171706e-01, 3.76886427e-01, 5.95246017e-01,
       4.87031907e-01, 9.98798609e-01, 5.03770769e-01, 4.96487498e-01,
       7.25180328e-01, 5.39901733e-01, 1.14436269e-01, 2.99044400e-01,
       9.21357512e-01, 5.64083993e-01, 3.41100067e-01, 3.32555801e-01,
       9.24055457e-01, 5.99725604e-01, 8.38051796e-01, 1.09694958e-01,
       5.63494146e-01, 1.20461337e-01, 4.21167433e-01, 9.61774588e-01,
       3.33909273e-01, 2.66393334e-01, 1.91199958e-01, 6.58743903e-02,
       3.29939905e-03, 2.29421392e-01, 4.58112538e-01, 4.72393006e-01,
       7.82953084e-01, 8.59366536e-01, 7.73691595e-01, 9.17094171e-01,
       1.34494200e-01, 9.85464394e-01, 2.90628493e-01, 8.15362036e-01,
       1.42962843e-01, 9.35251176e-01, 1.84095860e-01, 9.17438805e-01,
       8.48845661e-01, 1.49283946e-01, 6.43527567e-01, 4.91439909e-01,
       2.04187978e-04, 9.74248528e-01, 3.52177769e-02, 7.01530457e-01,
       2.29267493e-01, 3.73786986e-02, 9.57324564e-01, 2.33622506e-01,
       9.60032821e-01, 5.05452394e-01, 2.48971850e-01, 8.09755564e-01,
       4.07148972e-02, 5.91799282e-02, 3.64355206e-01, 1.71176121e-01,
       2.44690403e-01, 9.80700076e-01, 9.20932353e-01, 1.99488685e-01,
       7.34189749e-01, 1.28495649e-01, 1.29677560e-02, 3.02048445e-01,
       8.52683485e-01, 6.13745868e-01, 2.64557879e-02, 7.33073652e-01,
       9.28478301e-01, 4.47242051e-01, 9.46873963e-01, 6.17265105e-01,
       8.77478659e-01, 6.22962058e-01, 4.16158438e-01, 8.70441258e-01,
       1.28760770e-01, 6.65884078e-01, 3.09782743e-01, 3.74453276e-01,
       3.20772558e-01, 7.29788303e-01, 3.14494818e-01, 5.52449048e-01,
       2.80317217e-01, 2.80287325e-01, 4.49607432e-01, 3.21216255e-01,
       6.39839351e-01, 2.22188354e-01, 1.76943645e-01, 7.92106763e-02,
       2.71614939e-01, 3.62022161e-01, 5.19991040e-01, 5.17397702e-01,
       7.98965991e-01, 4.81150568e-01, 8.38890791e-01, 4.04397070e-01,
       3.62679213e-01, 7.27004945e-01, 4.67327237e-01, 7.39854351e-02,
       4.54124421e-01, 7.05168903e-01, 3.31499219e-01, 3.20511349e-02,
       8.48214090e-01, 4.68561739e-01, 4.66063648e-01, 7.31443644e-01,
       6.83556855e-01, 2.52349377e-01, 6.25465691e-01, 3.59815478e-01,
       5.86886525e-01, 5.26492894e-01, 2.73389161e-01, 6.61264479e-01,
       2.10690811e-01, 6.84140921e-01, 3.49763274e-01, 2.70160675e-01,
       6.43265188e-01, 8.38871896e-01, 4.92087096e-01, 1.76572263e-01,
       4.16473389e-01, 6.16283119e-01, 9.40418243e-01, 8.43072474e-01,
       7.75265872e-01, 7.67990291e-01, 6.00105166e-01, 3.78884465e-01,
       7.94472873e-01, 2.17910558e-01, 3.38915646e-01, 4.52309757e-01,
       4.91272628e-01, 7.81403244e-01, 4.53415126e-01, 4.15363222e-01,
       5.57945311e-01, 6.91688061e-01, 9.27446596e-03, 7.76369333e-01,
       8.52208674e-01, 3.16760361e-01, 5.40991127e-01, 6.70610011e-01,
       4.13098037e-01, 4.72259343e-01, 6.84576333e-02, 5.24280630e-02,
       2.18689904e-01, 4.95429516e-01, 4.63609070e-01, 4.19498295e-01,
       6.09843016e-01, 2.18339264e-01, 7.93177247e-01, 2.06750408e-01,
       4.43439990e-01, 5.31324968e-02, 7.07634032e-01, 1.67062253e-01,
       4.27430123e-02, 5.21094501e-01, 6.32939935e-01, 6.50189042e-01,
       4.33291674e-01, 6.30978465e-01, 6.94349706e-02, 1.84334621e-01,
       9.47676748e-02, 4.16002907e-02, 6.64120018e-01, 2.97599643e-01,
       9.06884223e-02, 3.31310064e-01, 4.21620578e-01, 6.83054179e-02,
       2.34887347e-01, 3.79241645e-01, 3.35537046e-01, 4.95025843e-01,
       1.00468220e-02, 2.28745311e-01, 6.69329405e-01, 7.29600787e-02,
       6.41683519e-01, 5.11392474e-01, 5.63332498e-01, 9.10971701e-01,
       1.58158429e-02, 1.38357148e-01, 6.82387799e-02, 7.55052388e-01,
       9.82282579e-01, 2.11690944e-02, 4.04511653e-02, 9.83132780e-01,
       8.70744467e-01, 7.65970722e-02, 1.06137633e-01, 6.37952834e-02,
       1.35804757e-01, 4.95464891e-01, 3.99038315e-01, 7.74711013e-01,
       8.77556980e-01, 7.31494844e-01, 8.49262357e-01, 1.80715412e-01,
       8.58075082e-01, 4.13116932e-01, 4.97205138e-01, 7.47738481e-01,
       3.18718374e-01, 5.12518883e-02, 9.66328681e-01, 6.85462296e-01,
       2.77051866e-01, 5.61538458e-01, 3.77648711e-01, 1.88045740e-01,
       6.71490431e-01, 8.46407890e-01, 1.64235815e-01, 6.87834322e-01,
       9.07136947e-02, 3.94660085e-01, 3.05658937e-01, 1.96535200e-01,
       2.54615247e-02, 5.31568766e-01, 9.88965511e-01, 8.99110436e-01,
       3.72278720e-01, 3.88998955e-01, 6.17105246e-01, 5.99022388e-01,
       8.73665392e-01, 3.61524910e-01, 3.64950925e-01, 4.73734498e-01,
       4.11509216e-01, 7.73669958e-01, 9.80675295e-02, 8.19212377e-01,
       3.19029987e-01, 3.96242678e-01, 1.38434231e-01, 4.52358842e-01,
       8.36389720e-01, 3.10222775e-01, 3.83639753e-01, 3.37498754e-01,
       8.36540222e-01, 8.97871912e-01, 1.50486141e-01, 1.08453475e-01,
       2.93728769e-01, 2.56447911e-01, 7.39043415e-01, 1.13210179e-01,
       4.46316302e-01, 6.35473609e-01, 5.58257282e-01, 7.52290010e-01,
       2.41069913e-01, 4.97457743e-01, 9.49434817e-01, 4.40553814e-01,
       6.28195584e-01, 5.94184518e-01, 6.10438943e-01, 5.38967609e-01,
       9.59037483e-01, 8.79278481e-01, 1.37715042e-01, 1.44743562e-01,
       6.09349728e-01, 7.58314788e-01, 4.62189764e-01, 2.29672983e-01,
       9.79865074e-01, 9.60876226e-01, 6.54523969e-02, 2.83805430e-01,
       4.51579034e-01, 6.67674482e-01, 4.54834849e-01, 4.65486944e-01,
       9.61396158e-01, 5.17292738e-01, 4.01838183e-01, 5.18756688e-01,
       1.42737478e-01, 2.19862521e-01, 3.34246814e-01, 7.18258858e-01,
       3.17296743e-01, 4.99515653e-01, 2.52541423e-01, 5.72858691e-01,
       3.38269174e-01, 5.30649006e-01, 6.49369461e-03, 6.80236638e-01,
       4.85730320e-01, 8.97724330e-01, 8.28289568e-01, 6.86036825e-01,
       6.37103617e-01, 6.59882486e-01, 5.99916816e-01, 8.86413693e-01,
       5.61470628e-01, 8.46448958e-01, 3.59398603e-01, 5.83821177e-01,
       8.85347068e-01, 8.31316948e-01, 8.80407467e-02, 3.65901381e-01,
       7.51738310e-01, 7.97282577e-01, 6.37924194e-01, 2.43133567e-02,
       6.57234907e-01, 7.37769306e-01, 2.34730527e-01, 3.93983036e-01,
       2.01524928e-01, 5.22921264e-01, 5.93141198e-01, 8.32951725e-01,
       7.01063395e-01, 6.60746217e-01, 1.41838923e-01, 1.20144978e-01,
       5.40323965e-02, 2.19392627e-01, 3.41572732e-01, 4.58034933e-01,
       6.35955572e-01, 8.57032061e-01, 8.40842962e-01, 4.24393445e-01,
       6.81003451e-01, 8.09939206e-01, 9.98931974e-02, 8.13999593e-01,
       4.92103785e-01, 3.49567950e-01, 5.57509840e-01, 3.64384204e-01],
      dtype=float32)},
            metadata_index={'by_key': {}},
            action_index={},
            outcome_index={},
            temporal_index=[],
            dimension=384)
        self       = <memory.test_episodic_memory.TestMemoryIndex object at 0x132a39640>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
____________________ TestMemoryIndex.test_remove_embedding _____________________
tests/unit/agent/memory/test_episodic_memory.py:326: in test_remove_embedding
    assert episode_id in index._embeddings
                         ^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryIndex' object has no attribute '_embeddings'. Did you mean: 'embeddings'?
        embedding  = array([8.70248318e-01, 3.72189045e-01, 7.70607471e-01, 3.01005006e-01,
       4.45938259e-01, 5.49970090e-01, 8.32565129e-02, 7.58549571e-01,
       9.94905472e-01, 1.75331682e-01, 2.15342388e-01, 2.76802927e-01,
       2.99717724e-01, 9.45547298e-02, 9.00544524e-02, 1.68920960e-02,
       1.30110875e-01, 8.99324954e-01, 6.03916384e-02, 7.45891511e-01,
       4.05791432e-01, 6.31594777e-01, 2.65961122e-02, 9.85626757e-01,
       4.73557472e-01, 2.21243396e-01, 7.47110724e-01, 3.99232537e-01,
       2.93581069e-01, 9.96504426e-01, 4.43993181e-01, 7.41800547e-01,
       8.57218742e-01, 7.23888934e-01, 6.56446040e-01, 9.20841694e-01,
       1.71769798e-01, 7.89029598e-01, 8.40364873e-01, 7.44941473e-01,
       3.71673524e-01, 7.29408979e-01, 5.39242387e-01, 8.28545392e-01,
       4.01947051e-01, 4.73710805e-01, 9.04192507e-01, 9.24519956e-01,
       4.43373621e-01, 3.32665026e-01, 5.65569699e-01, 4.23311353e-01,
       5.76131225e-01, 3.20532620e-01, 7.91700721e-01, 2.18473151e-01,
       1.34303644e-01, 6.77438021e-01, 3.63558412e-01, 7.53054440e-01,
       4.98791009e-01, 2.66203403e-01, 3.47359389e-01, 7.11920917e-01,
       4.70563769e-01, 2.58246273e-01, 3.33877772e-01, 1.72050074e-01,
       3.77709299e-01, 8.12759638e-01, 4.97008473e-01, 8.28282058e-01,
       3.63405049e-01, 7.55241513e-01, 1.93422332e-01, 6.75046921e-01,
       1.75550759e-01, 4.10966903e-01, 2.11781934e-01, 7.25625992e-01,
       7.42416918e-01, 7.19878748e-02, 3.78557853e-02, 7.42721081e-01,
       6.84231460e-01, 9.47957814e-01, 3.81297886e-01, 7.34917045e-01,
       8.75668168e-01, 8.09006870e-01, 5.92104614e-01, 8.71662498e-01,
       8.08210373e-01, 9.33709800e-01, 8.97936940e-01, 2.79039424e-03,
       6.68195039e-02, 6.48220897e-01, 9.69586253e-01, 4.72239226e-01,
       4.74565685e-01, 1.30855694e-01, 8.06767285e-01, 1.24450788e-01,
       8.52941990e-01, 6.87404573e-01, 4.80956644e-01, 4.98436093e-01,
       7.61489451e-01, 2.79345930e-01, 9.42561746e-01, 7.27086484e-01,
       3.35248649e-01, 4.15099114e-01, 6.48170114e-01, 3.29239637e-01,
       4.70900908e-02, 4.77673501e-01, 4.40621197e-01, 4.33451295e-01,
       5.88138819e-01, 2.72680461e-01, 3.54686052e-01, 7.32084572e-01,
       8.53095412e-01, 4.33851093e-01, 8.63324925e-02, 7.98887253e-01,
       3.25023234e-01, 6.63711548e-01, 1.96344897e-01, 5.84823592e-03,
       3.15932006e-01, 3.88577461e-01, 3.84831518e-01, 6.51508629e-01,
       3.90114009e-01, 6.07838631e-01, 8.62827301e-01, 7.28000581e-01,
       9.36000824e-01, 2.94502497e-01, 3.98986995e-01, 9.29987013e-01,
       2.92326454e-02, 7.04963207e-01, 2.38327801e-01, 7.90477172e-03,
       6.38660714e-02, 7.05668867e-01, 7.37439990e-01, 7.97077060e-01,
       5.96193790e-01, 6.51932597e-01, 6.88365459e-01, 9.17842053e-03,
       5.42292520e-02, 3.21356356e-02, 2.95490861e-01, 6.52756274e-01,
       1.18847422e-01, 8.92502427e-01, 2.52640724e-01, 9.46542561e-01,
       5.32084167e-01, 4.68669534e-01, 7.82962590e-02, 6.57902181e-01,
       7.73225129e-01, 5.96920907e-01, 4.22288239e-01, 5.09570420e-01,
       3.57799977e-01, 8.48406374e-01, 5.98140061e-01, 4.39049453e-01,
       8.78095031e-01, 4.70904440e-01, 2.12779522e-01, 4.95491505e-01,
       6.99513674e-01, 4.66965020e-01, 1.22743562e-01, 9.75123882e-01,
       1.06411919e-01, 2.17047229e-01, 6.14094377e-01, 1.03286877e-01,
       9.78595257e-01, 7.85601914e-01, 1.57422841e-01, 3.44299287e-01,
       8.52305830e-01, 1.82570070e-01, 8.39082837e-01, 7.57933617e-01,
       5.62699020e-01, 5.57784975e-01, 5.85990369e-01, 7.16287732e-01,
       9.86097753e-01, 3.36236268e-01, 1.97137877e-01, 1.18647717e-01,
       2.39010558e-01, 3.75487983e-01, 7.66005774e-04, 4.26916361e-01,
       2.87922055e-01, 7.08418071e-01, 8.54605585e-02, 7.41582990e-01,
       2.09711820e-01, 4.25948687e-02, 4.46322083e-01, 3.30442697e-01,
       1.36634126e-01, 6.72613800e-01, 4.82845217e-01, 4.58177745e-01,
       8.55440855e-01, 3.09916079e-01, 3.88070792e-02, 1.68325026e-02,
       4.09232616e-01, 5.20637453e-01, 9.83722210e-01, 2.04226509e-01,
       3.47981721e-01, 5.91295302e-01, 4.40655261e-01, 2.94665664e-01,
       1.84192970e-01, 8.58332634e-01, 8.51250470e-01, 4.56181318e-01,
       6.39315844e-01, 3.99181455e-01, 9.58985090e-01, 4.91797417e-01,
       2.83145815e-01, 2.72370905e-01, 1.39132515e-01, 3.44334424e-01,
       7.83531785e-01, 5.13298631e-01, 6.96872294e-01, 2.92447716e-01,
       7.53440440e-01, 9.66642201e-01, 8.79966259e-01, 3.78906131e-01,
       8.45263228e-02, 4.86583635e-03, 5.94221711e-01, 5.84226847e-01,
       4.41123813e-01, 2.41439432e-01, 3.76378477e-01, 1.36169702e-01,
       5.58316708e-01, 6.00674868e-01, 6.38430893e-01, 5.23863792e-01,
       7.43145168e-01, 1.09720312e-01, 6.73246980e-01, 6.85068890e-02,
       9.61177647e-01, 5.85351825e-01, 5.28317511e-01, 3.01836371e-01,
       4.05653775e-01, 4.54420596e-01, 4.27963793e-01, 9.30134237e-01,
       6.01516902e-01, 4.04085666e-01, 1.40991628e-01, 9.85955119e-01,
       5.84107816e-01, 5.78307092e-01, 6.47597194e-01, 1.68712288e-01,
       1.11762464e-01, 6.31662726e-01, 9.59341049e-01, 8.65037918e-01,
       9.91058588e-01, 6.87816739e-01, 9.80008185e-01, 3.29521269e-01,
       9.40544963e-01, 4.83980447e-01, 4.14292812e-01, 8.15501869e-01,
       6.18128061e-01, 1.49662569e-01, 5.38251519e-01, 2.09040362e-02,
       5.99014699e-01, 1.93632826e-01, 2.73447156e-01, 6.94393158e-01,
       8.73055279e-01, 8.16286862e-01, 6.02400303e-01, 9.17768002e-01,
       6.98304534e-01, 8.16193223e-01, 8.53338003e-01, 8.29824626e-01,
       1.01328678e-01, 8.44230115e-01, 1.14952028e-01, 8.25835541e-02,
       3.06932777e-01, 8.86045873e-01, 2.08614215e-01, 9.32098210e-01,
       5.74913800e-01, 1.41679078e-01, 1.30057216e-01, 5.97035050e-01,
       7.47407556e-01, 2.21189454e-01, 5.51495075e-01, 3.93645912e-01,
       2.42740914e-01, 5.16847730e-01, 3.13780755e-01, 1.11071654e-01,
       9.29927528e-01, 4.06897575e-01, 8.56917560e-01, 3.79944593e-01,
       2.75434732e-01, 6.79400623e-01, 2.64529437e-01, 2.12003648e-01,
       4.65395033e-01, 4.34363186e-01, 1.91501737e-01, 7.50956297e-01,
       1.12103112e-01, 2.78059334e-01, 2.32237369e-01, 7.51829982e-01,
       9.31110144e-01, 2.80939400e-01, 4.12689418e-01, 2.54931390e-01,
       7.76744306e-01, 8.99631560e-01, 6.14824057e-01, 8.69360268e-01,
       1.07049182e-01, 2.70182937e-01, 8.17281961e-01, 1.59476534e-01,
       9.62521672e-01, 9.85616207e-01, 2.02892482e-01, 6.32249534e-01,
       2.56345630e-01, 2.55982488e-01, 6.40836000e-01, 7.49716818e-01,
       5.05402505e-01, 8.61604869e-01, 6.63076341e-01, 9.31389928e-01,
       6.93701580e-02, 4.65033710e-01, 3.20261240e-01, 8.78625333e-01,
       7.74060309e-01, 8.24389696e-01, 5.24380267e-01, 7.33988464e-01,
       8.15515161e-01, 9.26865816e-01, 2.42026567e-01, 4.22157377e-01],
      dtype=float32)
        episode_id = 'test_id'
        index      = MemoryIndex(embeddings={'test_id': array([8.70248318e-01, 3.72189045e-01, 7.70607471e-01, 3.01005006e-01,
       4.45938259e-01, 5.49970090e-01, 8.32565129e-02, 7.58549571e-01,
       9.94905472e-01, 1.75331682e-01, 2.15342388e-01, 2.76802927e-01,
       2.99717724e-01, 9.45547298e-02, 9.00544524e-02, 1.68920960e-02,
       1.30110875e-01, 8.99324954e-01, 6.03916384e-02, 7.45891511e-01,
       4.05791432e-01, 6.31594777e-01, 2.65961122e-02, 9.85626757e-01,
       4.73557472e-01, 2.21243396e-01, 7.47110724e-01, 3.99232537e-01,
       2.93581069e-01, 9.96504426e-01, 4.43993181e-01, 7.41800547e-01,
       8.57218742e-01, 7.23888934e-01, 6.56446040e-01, 9.20841694e-01,
       1.71769798e-01, 7.89029598e-01, 8.40364873e-01, 7.44941473e-01,
       3.71673524e-01, 7.29408979e-01, 5.39242387e-01, 8.28545392e-01,
       4.01947051e-01, 4.73710805e-01, 9.04192507e-01, 9.24519956e-01,
       4.43373621e-01, 3.32665026e-01, 5.65569699e-01, 4.23311353e-01,
       5.76131225e-01, 3.20532620e-01, 7.91700721e-01, 2.18473151e-01,
       1.34303644e-01, 6.77438021e-01, 3.63558412e-01, 7.53054440e-01,
       4.98791009e-01, 2.66203403e-01, 3.47359389e-01, 7.11920917e-01,
       4.70563769e-01, 2.58246273e-01, 3.33877772e-01, 1.72050074e-01,
       3.77709299e-01, 8.12759638e-01, 4.97008473e-01, 8.28282058e-01,
       3.63405049e-01, 7.55241513e-01, 1.93422332e-01, 6.75046921e-01,
       1.75550759e-01, 4.10966903e-01, 2.11781934e-01, 7.25625992e-01,
       7.42416918e-01, 7.19878748e-02, 3.78557853e-02, 7.42721081e-01,
       6.84231460e-01, 9.47957814e-01, 3.81297886e-01, 7.34917045e-01,
       8.75668168e-01, 8.09006870e-01, 5.92104614e-01, 8.71662498e-01,
       8.08210373e-01, 9.33709800e-01, 8.97936940e-01, 2.79039424e-03,
       6.68195039e-02, 6.48220897e-01, 9.69586253e-01, 4.72239226e-01,
       4.74565685e-01, 1.30855694e-01, 8.06767285e-01, 1.24450788e-01,
       8.52941990e-01, 6.87404573e-01, 4.80956644e-01, 4.98436093e-01,
       7.61489451e-01, 2.79345930e-01, 9.42561746e-01, 7.27086484e-01,
       3.35248649e-01, 4.15099114e-01, 6.48170114e-01, 3.29239637e-01,
       4.70900908e-02, 4.77673501e-01, 4.40621197e-01, 4.33451295e-01,
       5.88138819e-01, 2.72680461e-01, 3.54686052e-01, 7.32084572e-01,
       8.53095412e-01, 4.33851093e-01, 8.63324925e-02, 7.98887253e-01,
       3.25023234e-01, 6.63711548e-01, 1.96344897e-01, 5.84823592e-03,
       3.15932006e-01, 3.88577461e-01, 3.84831518e-01, 6.51508629e-01,
       3.90114009e-01, 6.07838631e-01, 8.62827301e-01, 7.28000581e-01,
       9.36000824e-01, 2.94502497e-01, 3.98986995e-01, 9.29987013e-01,
       2.92326454e-02, 7.04963207e-01, 2.38327801e-01, 7.90477172e-03,
       6.38660714e-02, 7.05668867e-01, 7.37439990e-01, 7.97077060e-01,
       5.96193790e-01, 6.51932597e-01, 6.88365459e-01, 9.17842053e-03,
       5.42292520e-02, 3.21356356e-02, 2.95490861e-01, 6.52756274e-01,
       1.18847422e-01, 8.92502427e-01, 2.52640724e-01, 9.46542561e-01,
       5.32084167e-01, 4.68669534e-01, 7.82962590e-02, 6.57902181e-01,
       7.73225129e-01, 5.96920907e-01, 4.22288239e-01, 5.09570420e-01,
       3.57799977e-01, 8.48406374e-01, 5.98140061e-01, 4.39049453e-01,
       8.78095031e-01, 4.70904440e-01, 2.12779522e-01, 4.95491505e-01,
       6.99513674e-01, 4.66965020e-01, 1.22743562e-01, 9.75123882e-01,
       1.06411919e-01, 2.17047229e-01, 6.14094377e-01, 1.03286877e-01,
       9.78595257e-01, 7.85601914e-01, 1.57422841e-01, 3.44299287e-01,
       8.52305830e-01, 1.82570070e-01, 8.39082837e-01, 7.57933617e-01,
       5.62699020e-01, 5.57784975e-01, 5.85990369e-01, 7.16287732e-01,
       9.86097753e-01, 3.36236268e-01, 1.97137877e-01, 1.18647717e-01,
       2.39010558e-01, 3.75487983e-01, 7.66005774e-04, 4.26916361e-01,
       2.87922055e-01, 7.08418071e-01, 8.54605585e-02, 7.41582990e-01,
       2.09711820e-01, 4.25948687e-02, 4.46322083e-01, 3.30442697e-01,
       1.36634126e-01, 6.72613800e-01, 4.82845217e-01, 4.58177745e-01,
       8.55440855e-01, 3.09916079e-01, 3.88070792e-02, 1.68325026e-02,
       4.09232616e-01, 5.20637453e-01, 9.83722210e-01, 2.04226509e-01,
       3.47981721e-01, 5.91295302e-01, 4.40655261e-01, 2.94665664e-01,
       1.84192970e-01, 8.58332634e-01, 8.51250470e-01, 4.56181318e-01,
       6.39315844e-01, 3.99181455e-01, 9.58985090e-01, 4.91797417e-01,
       2.83145815e-01, 2.72370905e-01, 1.39132515e-01, 3.44334424e-01,
       7.83531785e-01, 5.13298631e-01, 6.96872294e-01, 2.92447716e-01,
       7.53440440e-01, 9.66642201e-01, 8.79966259e-01, 3.78906131e-01,
       8.45263228e-02, 4.86583635e-03, 5.94221711e-01, 5.84226847e-01,
       4.41123813e-01, 2.41439432e-01, 3.76378477e-01, 1.36169702e-01,
       5.58316708e-01, 6.00674868e-01, 6.38430893e-01, 5.23863792e-01,
       7.43145168e-01, 1.09720312e-01, 6.73246980e-01, 6.85068890e-02,
       9.61177647e-01, 5.85351825e-01, 5.28317511e-01, 3.01836371e-01,
       4.05653775e-01, 4.54420596e-01, 4.27963793e-01, 9.30134237e-01,
       6.01516902e-01, 4.04085666e-01, 1.40991628e-01, 9.85955119e-01,
       5.84107816e-01, 5.78307092e-01, 6.47597194e-01, 1.68712288e-01,
       1.11762464e-01, 6.31662726e-01, 9.59341049e-01, 8.65037918e-01,
       9.91058588e-01, 6.87816739e-01, 9.80008185e-01, 3.29521269e-01,
       9.40544963e-01, 4.83980447e-01, 4.14292812e-01, 8.15501869e-01,
       6.18128061e-01, 1.49662569e-01, 5.38251519e-01, 2.09040362e-02,
       5.99014699e-01, 1.93632826e-01, 2.73447156e-01, 6.94393158e-01,
       8.73055279e-01, 8.16286862e-01, 6.02400303e-01, 9.17768002e-01,
       6.98304534e-01, 8.16193223e-01, 8.53338003e-01, 8.29824626e-01,
       1.01328678e-01, 8.44230115e-01, 1.14952028e-01, 8.25835541e-02,
       3.06932777e-01, 8.86045873e-01, 2.08614215e-01, 9.32098210e-01,
       5.74913800e-01, 1.41679078e-01, 1.30057216e-01, 5.97035050e-01,
       7.47407556e-01, 2.21189454e-01, 5.51495075e-01, 3.93645912e-01,
       2.42740914e-01, 5.16847730e-01, 3.13780755e-01, 1.11071654e-01,
       9.29927528e-01, 4.06897575e-01, 8.56917560e-01, 3.79944593e-01,
       2.75434732e-01, 6.79400623e-01, 2.64529437e-01, 2.12003648e-01,
       4.65395033e-01, 4.34363186e-01, 1.91501737e-01, 7.50956297e-01,
       1.12103112e-01, 2.78059334e-01, 2.32237369e-01, 7.51829982e-01,
       9.31110144e-01, 2.80939400e-01, 4.12689418e-01, 2.54931390e-01,
       7.76744306e-01, 8.99631560e-01, 6.14824057e-01, 8.69360268e-01,
       1.07049182e-01, 2.70182937e-01, 8.17281961e-01, 1.59476534e-01,
       9.62521672e-01, 9.85616207e-01, 2.02892482e-01, 6.32249534e-01,
       2.56345630e-01, 2.55982488e-01, 6.40836000e-01, 7.49716818e-01,
       5.05402505e-01, 8.61604869e-01, 6.63076341e-01, 9.31389928e-01,
       6.93701580e-02, 4.65033710e-01, 3.20261240e-01, 8.78625333e-01,
       7.74060309e-01, 8.24389696e-01, 5.24380267e-01, 7.33988464e-01,
       8.15515161e-01, 9.26865816e-01, 2.42026567e-01, 4.22157377e-01],
      dtype=float32)},
            metadata_index={'by_key': {}},
            action_index={},
            outcome_index={},
            temporal_index=[],
            dimension=384)
        self       = <memory.test_episodic_memory.TestMemoryIndex object at 0x132a39a90>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
_____________________ TestMemoryIndex.test_index_metadata ______________________
tests/unit/agent/memory/test_episodic_memory.py:360: in test_index_metadata
    assert episode_id in index._metadata_index
                         ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryIndex' object has no attribute '_metadata_index'. Did you mean: 'metadata_index'?
        episode_id = 'test_id'
        index      = MemoryIndex(embeddings={},
            metadata_index={'by_key': {'complexity': {'medium': ['test_id']},
                                       'task_type': {'bugfix': ['test_id']}}},
            action_index={},
            outcome_index={},
            temporal_index=[],
            dimension=384)
        metadata   = {'complexity': 'medium', 'task_type': 'bugfix'}
        self       = <memory.test_episodic_memory.TestMemoryIndex object at 0x132a3a810>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
______________________ TestMemoryIndex.test_index_actions ______________________
tests/unit/agent/memory/test_episodic_memory.py:372: in test_index_actions
    assert episode_id in index._action_index
                         ^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryIndex' object has no attribute '_action_index'. Did you mean: 'action_index'?
        actions    = ['read_file', 'edit_file', 'run_tests']
        episode_id = 'test_id'
        index      = MemoryIndex(embeddings={},
            metadata_index={'by_key': {}},
            action_index={'edit_file': ['test_id'],
                          'read_file': ['test_id'],
                          'run_tests': ['test_id']},
            outcome_index={},
            temporal_index=[],
            dimension=384)
        self       = <memory.test_episodic_memory.TestMemoryIndex object at 0x132a3ac90>
------------------------------ Captured log setup ------------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
---------------------------- Captured log teardown -----------------------------
DEBUG    victor.storage.embeddings.task_classifier:task_classifier.py:1298 Reset TaskTypeClassifier singleton
DEBUG    victor.storage.embeddings.intent_classifier:intent_classifier.py:466 Reset IntentClassifier singleton
DEBUG    victor.agent.shared_tool_registry:shared_tool_registry.py:154 SharedToolRegistry instance reset
DEBUG    victor.core.registry_base:registry_base.py:151 ProgressiveToolsRegistry singleton instance reset
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_query' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_query'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_context' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_context'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
DEBUG    victor.core.registries.universal_registry:universal_registry.py:187 UniversalRegistry: Created 'tool_selection_rl' with strategy=lru, max_size=1000
INFO     victor.core.registries.universal_registry:universal_registry.py:219 UniversalRegistry: Created new registry 'tool_selection_rl'
DEBUG    victor.core.registries.universal_registry:universal_registry.py:419 UniversalRegistry: Cleared all entries (0 total)
=========================== short test summary info ============================
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_simple_response - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_token_usage_tracking - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_tool_calls - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_empty_response_uses_completer - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_max_iterations_exceeded - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_thinking_enabled - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_with_context_compaction - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorChat::test_chat_tool_failure_uses_completer - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorEdgeCases::test_chat_completer_fails_uses_fallback - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorEdgeCases::test_chat_with_tool_failures_uses_format_message - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/coordinators/test_chat_coordinator.py::TestChatCoordinatorEdgeCases::test_chat_provider_exception_propagates - TypeError: argument of type 'Mock' is not iterable
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestEpisodeMemory::test_episode_memory_update_access - AssertionError: assert 0 == (0 + 1)
 +  where 0 = Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0).access_count
 +    where Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0) = EpisodeMemory(episode=Episode(id=97e26b2f..., timestamp=2026-01-21T02:16:06.976352, actions=3, reward=0.0), embedding_id='e7ba926a-f55c-42f2-a933-f830ec197835', created_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 976585), updated_at=datetime.datetime(2026, 1, 21, 2, 16, 6, 976615), access_count=1, last_accessed=datetime.datetime(2026, 1, 21, 2, 16, 6, 976606), metadata={}).episode
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestEpisodeMemory::test_episode_memory_to_dict - AttributeError: 'EpisodeMemory' object has no attribute 'to_dict'
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryStats::test_memory_stats_creation - TypeError: MemoryStats.__init__() got an unexpected keyword argument 'episode_count'
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryStats::test_memory_stats_default_values - TypeError: MemoryStats.__init__() got an unexpected keyword argument 'episode_count'
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_memory_index_creation - AttributeError: 'MemoryIndex' object has no attribute '_embeddings'. Did you mean: 'embeddings'?
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_add_embedding - AttributeError: 'MemoryIndex' object has no attribute '_embeddings'. Did you mean: 'embeddings'?
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_remove_embedding - AttributeError: 'MemoryIndex' object has no attribute '_embeddings'. Did you mean: 'embeddings'?
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_index_metadata - AttributeError: 'MemoryIndex' object has no attribute '_metadata_index'. Did you mean: 'metadata_index'?
FAILED tests/unit/agent/memory/test_episodic_memory.py::TestMemoryIndex::test_index_actions - AttributeError: 'MemoryIndex' object has no attribute '_action_index'. Did you mean: 'action_index'?
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 20 failures !!!!!!!!!!!!!!!!!!!!!!!!!!
= 20 failed, 1757 passed, 3 skipped, 5 deselected, 103 warnings in 60.10s (0:01:00) =
